<!doctype html>
<html lang="en" ng-app="carApp">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="renderer" content="webkit">
    <title>index</title>
    <link rel="stylesheet" href="__PUBLIC__/css/style.css">
    <link rel="stylesheet" href="__PUBLIC__/css/bootstrap.css">
    <link rel="stylesheet" href="__PUBLIC__/css/bootstrap-theme.css">
    <link rel="stylesheet" href="__PUBLIC__/css/font-awesome.min.css">
    <!--页面过渡动画-->
    <link rel="stylesheet" href="__PUBLIC__/css/animation/animations.css">
    <link rel="stylesheet" href="__PUBLIC__/css/animation/component.css">
    <script src="__PUBLIC__/js/animation/modernizr.custom.js"></script>
    <script src="//cdn.bootcss.com/angular.js/1.5.0-beta.1/angular.min.js"></script>
</head>
<body ng-controller="DemandCtrl">


<div id="pt-main" class="pt-perspective">
    <div class="pt-page pt-page-1">
        <div class="pt-triggers">
            <button id="iterateEffects" class="pt-touch-button">显示下一页切换</button>
        </div>
        <!-- /triggers -->
        <div id="echarts-x-content"></div>
        <div class="pt-message">
            <p>亲，你的浏览器不支持 CSS 动画，请使用 Chrome,Firefox,Safari 等浏览器浏览.</p>
        </div>
    </div>
    <div class="pt-page pt-page-2 row">
        <div class="left-container col-lg-3">
            <section class="left-top">
                <div class="left-top-text">
                    <p>当前位置 :<span>&nbsp;&nbsp;{{posi.start}}</span></p>

                    <p>目标位置 :<span>&nbsp;&nbsp;{{posi.end}}</span></p>
                </div>
                <div id="radar-chart"></div>
            </section>
            <section class="left-mid">
                <ul ng-repeat="park_record in park_records">
                    <li>
                        <p>{{park_record.start}}~{{park_record.end}}</p>

                        <p>{{park_record.park_name}} 消费{{park_record.money}}元</p>
                    </li>
                </ul>
            </section>
            <section class="left-bottom">
                <div class="left-bottom-text">
                    <p>天气：<span>晴</span></p>

                    <p>风力：<span>3级</span></p>

                    <p>温度：<span>2-10C</span></p>

                    <p class="weather">雾</p>
                </div>
                <div class="left-bottom-scroll">
                    <ul>
                        <li>
                            正午，大雾天气有所缓解，目前青银高速、青新高速、沈海高速青岛段已经解除管制，正常开通。胶州湾高速、龙青高速仍然封闭
                        </li>
                        <li>
                            鲁UT4485利群出租公司的姜师傅三年每周三次早晨7:20准时接送一位老人去医院做透析，默默无闻的付出，
                            并且不收取车费， 真是凡人善举，风雨无阻，春夏秋冬！这个冬天里，这是我们听到的最温暖的心声！感动，
                            祝福姜师傅，好人一生平安！
                        </li>
                        <li>
                            30日，首批10辆纯电动公交车开始在交运集团“温馨巴士”31路公交线上投入运行。根据计划，
                            该线路公交车将在今年一季度陆续更新，也成为交运集团在市区的首条纯电动公交线。
                        </li>
                        <li>
                            冬天汽车要小心保养，因为气温很低，汽车部分的零部件比较脆弱，
                            要小心使用才能保护好自己的爱车。蜀黍整理了一些冬季汽车保养常识，希望对大家有所帮助
                        </li>
                        <li>
                            最新消息：胶州湾高速、龙青高速全线开通
                        </li>
                        <li>
                            正午，大雾天气有所缓解，目前青银高速、青新高速、沈海高速青岛段已经解除管制，正常开通。胶州湾高速、龙青高速仍然封闭
                        </li>
                    </ul>
                </div>
            </section>
        </div>
        <div class="car-container col-lg-6">
            <section class="car-user clearfix">
                <img src="{{u.img}}" alt="车主">
                <ul>
                    <li>
                        <p>用户名：<span>{{u.name}}</span></p>
                    </li>
                    <li>
                        <p>性别：<span>男</span></p>
                    </li>
                    <li>
                        <p>年龄：<span>33</span></p>
                    </li>
                    <li>
                        <p>职业：<span>歌手</span></p>
                    </li>
                    <li>
                        <p>驾龄：<span>3年</span></p>
                    </li>
                    <li>
                        <!--i标签为小星星，i的数量即为星星的数量-->
                        <p>信用情况：<span>
                            <i class="icon-star"></i>
                            <i class="icon-star"></i>
                        </span></p>
                    </li>
                </ul>
            </section>
            <section class="car-charts clearfix">
                <div id="car-charts1"></div>
                <div id="car-charts2"></div>
            </section>
            <section class="car-content">
                <section id="myCar"></section>
                <ul class="car-list">
                    <li><p>创业大厦停车场</p></li>
                    <li><p>创业大厦停车场</p></li>
                    <li><p>创业大厦停车场</p></li>
                    <li><p>创业大厦停车场</p></li>
                    <li><p>创业大厦停车场</p></li>
                    <li><p>创业大厦停车场</p></li>
                    <li><p>创业大厦停车场</p></li>
                    <li><p>创业大厦停车场</p></li>
                </ul>
            </section>
            <section class="car-bottom clearfix">
                <section class="car-bottom-text">
                    <div class="car-content-text">
                        <ul>
                            <li>
                                $park_id = 0;//所有停车厂

                                $t = I('post.time');

                                $start_time = I('post.start_time');
                                $end_time = I('post.end_time');

                                //echo $start_time;
                                $now = strtotime("now ");

                                $cout_start;
                                $cut_time = $now - $t * 60 * 60;
                                $now_h = date("H", $now) + 1;

                                if ($park_id == 0) {
                                if ($t == 24) {
                                for ($i = 0; $i < 24; $i++) {
                                $business [$i] = 0;
                                }
                                for ($j = 0; $j < 24; $j++) {
                                $side[$j] = 0;
                                }
                                for ($h = 0; $h < 24; $h++) {
                                $private [$h] = 0;
                                }
                                for ($h = 0; $h < 24; $h++) {
                                $total [$h] = 0;
                                }
                                $p = 0;
                                $n = $now_h - 1;
                                // $cut_time = $now - $time * 60 * 60;
                                for ($h = 23; $h >= 0; $h--) {

                                if ($n - $p >= 0)
                                $ti[$h] = $n - $p;
                                else
                                $ti[$h] = $n - $p + 24;
                                $p++;

                                }
                                for ($j = 0; $j < 24; $j++) {
                                $time[$j] = $ti[$j] . ":00";

                                }
                                // sort($time);
                                $resut_btime = M()->query //商业车厂(1)查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=1
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>$cut_time
                                ORDER BY start_time asc ");

                                for ($i = 0; $i < count($resut_btime); $i++) {
                                $shour = date("H", $resut_btime [$i] ['start_time']);
                                if ($shour > $now_h)
                                $num = $shour - $now_h;
                                else {
                                $num = $shour - $now_h + 24;
                                }

                                $business[$num] = $business[$num] + 1;
                                $total[$num] = $total[$num] + 1;
                                }
                                $resut_stime = M()->query //路测（2）车厂查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=2
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>$cut_time
                                ORDER BY start_time asc ");
                                //echo "f".count ( $resut_stime );
                                for ($i = 0; $i < count($resut_stime); $i++) {
                                $shour = date("H", $resut_stime [$i] ['start_time']);
                                if ($shour > $now_h)
                                $num = $shour - $now_h;
                                else {
                                $num = $shour - $now_h + 24;
                                }

                                $side[$num] = $side[$num] + 1;
                                $total[$num] = $total[$num] + 1;
                                }

                                $resut_ptime = M()->query //私家车（3）车厂查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=3
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>$cut_time
                                ORDER BY start_time asc ");

                                for ($i = 0; $i < count($resut_ptime); $i++) {
                                $shour = date("H", $resut_ptime [$i] ['start_time']);
                                if ($shour > $now_h)
                                $num = $shour - $now_h;
                                else {
                                $num = $shour - $now_h + 24;
                                }

                                $private[$num] = $private[$num] + 1;
                                $total[$num] = $total[$num] + 1;

                                }
                                // echo "".$cut_time;
                                //print_r($business);

                                $array = array(
                                "time" => $time,
                                "business" => $business,
                                "side" => $side,
                                "private" => $private,
                                "total" => $total,
                                );

                                echo json_encode($array);
                                }
                                if ($start_time) {
                                //echo "fse";
                                $start_day = date("d", strtotime($start_time));
                                $start_month = date("m", strtotime($start_time));
                                $end_day = date("d", strtotime($end_time));
                                $end_month = date("m", strtotime($end_time));
                                $s = strtotime($start_time);
                                $e = strtotime($end_time);
                                $i = 0;
                                $num = 0;
                                while ($s <= $e) {

                                $time[$i] = date("d", $s);
                                $s = $s + 86400;
                                // echo "i".$time[$i]."<br>";
                                $i++;
                                $num++;
                                //echo "nuddd".$num."<br>";

                                }

                                //echo "nuddd".$num;

                                for ($i = 0; $i < $num; $i++) {
                                $business [$i] = 0;
                                }
                                for ($j = 0; $j < $num; $j++) {
                                $side[$j] = 0;
                                }
                                for ($h = 0; $h < $num; $h++) {
                                $private [$h] = 0;
                                }
                                for ($h = 0; $h < $num; $h++) {
                                $total [$h] = 0;
                                }
                                //echo"fse".$end_time;
                                $as = strtotime($start_time);
                                $ae = strtotime($end_time) + 86400;
                                $resut_btime = M()->query //商业车厂(1)查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=1
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>=$as
                                AND px_parkrecord.start_time<=$ae
                                ORDER BY start_time asc ");
                                for ($j = 0; $j < count($resut_btime); $j++) {
                                $d = date('Y-m-d', $resut_btime [$j] ['start_time']);

                                $dd = strtotime(date('Y-m-d', $as));
                                $ns = (int)((strtotime($d) - $dd) / 86400);
                                $business[$ns] = $business[$ns] + 1;
                                $total[$ns] = $total[$ns] + 1;
                                }

                                $resut_stime = M()->query //路测车厂(2)查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=2
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>=$as
                                AND px_parkrecord.start_time<=$ae
                                ORDER BY start_time asc ");
                                //echo "uoo".count( $resut_stime );
                                for ($j = 0; $j < count($resut_stime); $j++) {
                                $d = date('Y-m-d', $resut_stime [$j] ['start_time']);

                                $ns = (int)((strtotime($d) - $dd) / 86400);
                                $side[$ns] = $side[$ns] + 1;
                                $total[$ns] = $total[$ns] + 1;
                                }

                                $resut_ptime = M()->query //私人车厂(3)查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=3
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>=$as
                                AND px_parkrecord.start_time<=$ae
                                ORDER BY start_time asc ");

                                /* echo "as".$as;
                                echo "ae".$ae;
                                echo "uu".count( $resut_ptime ); */
                                for ($j = 0; $j < count($resut_ptime); $j++) {
                                $d = date('Y-m-d', $resut_ptime [$j] ['start_time']);
                                $dd = strtotime(date('Y-m-d', $as));
                                $ns = (int)((strtotime($d) - $dd) / 86400);
                                $private[$ns] = $private[$ns] + 1;
                                $total[$ns] = $total[$ns] + 1;
                                // echo "dd".$private[$ns];
                                }

                                $array = array(
                                "time" => $time,
                                "business" => $business,
                                "side" => $side,
                                "private" => $private,
                                "total" => $total,
                                );

                                echo json_encode($array);

                                }
                                } else {
                                if ($t == 24) {
                                for ($i = 0; $i < 24; $i++) {
                                $business [$i] = 0;
                                }
                                for ($j = 0; $j < 24; $j++) {
                                $side[$j] = 0;
                                }
                                for ($h = 0; $h < 24; $h++) {
                                $private [$h] = 0;
                                }
                                for ($h = 0; $h < 24; $h++) {
                                $total [$h] = 0;
                                }
                                $p = 0;
                                $n = $now_h - 1;
                                // $cut_time = $now - $time * 60 * 60;
                                for ($h = 23; $h >= 0; $h--) {

                                if ($n - $p >= 0)
                                $ti[$h] = $n - $p;
                                else
                                $ti[$h] = $n - $p + 24;
                                $p++;

                                }
                                for ($j = 0; $j < 24; $j++) {
                                $time[$j] = $ti[$j];

                                }
                                // sort($time);
                                $resut_btime = M()->query //商业车厂(1)查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=1
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>$cut_time
                                AND px_parkrecord.park_id=$park_id
                                ORDER BY start_time asc ");

                                for ($i = 0; $i < count($resut_btime); $i++) {
                                $shour = date("H", $resut_btime [$i] ['start_time']);
                                if ($shour > $now_h)
                                $num = $shour - $now_h;
                                else {
                                $num = $shour - $now_h + 24;
                                }

                                $business[$num] = $business[$num] + 1;
                                $total[$num] = $total[$num] + 1;
                                // echo "shour" . $shour . "<br>";
                                // echo "num" . $num . "<br>";
                                // echo "svalue" . $in [abs ( $now_h - $shour )] . "<br>";
                                }


                                $resut_stime = M()->query //路测（2）车厂查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=2
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>$cut_time
                                AND px_parkrecord.park_id=$park_id
                                ORDER BY start_time asc ");

                                for ($i = 0; $i < count($resut_stime); $i++) {
                                $shour = date("H", $resut_stime [$i] ['start_time']);
                                if ($shour > $now_h)
                                $num = $shour - $now_h;
                                else {
                                $num = $shour - $now_h + 24;
                                }

                                $side[$num] = $side[$num] + 1;
                                $total[$num] = $total[$num] + 1;
                                // echo "shour" . $shour . "<br>";
                                // echo "num" . $num . "<br>";
                                // echo "svalue" . $in [abs ( $now_h - $shour )] . "<br>";
                                }

                                $resut_ptime = M()->query //私家车（3）车厂查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=3
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>$cut_time
                                AND px_parkrecord.park_id=$park_id
                                ORDER BY start_time asc ");

                                for ($i = 0; $i < count($resut_ptime); $i++) {
                                $shour = date("H", $resut_ptime [$i] ['start_time']);
                                if ($shour > $now_h)
                                $num = $shour - $now_h;
                                else {
                                $num = $shour - $now_h + 24;
                                }

                                $private[$num] = $private[$num] + 1;
                                $total[$num] = $total[$num] + 1;

                                }
                                //echo "".$cut_time;
                                //print_r($business);

                                $array = array(
                                "time" => $time,
                                "business" => $business,
                                "side" => $side,
                                "private" => $private,
                                "total" => $total,
                                );
                                /* $d=strtotime('2015-7-2');
                                $as=strtotime('2015-7-1');
                                echo "ffffffffff".$d;
                                $ns=(int)(($d-$as)/86400);
                                echo "d".$ns;*/
                                echo json_encode($array);
                                }
                                if ($start_time) {
                                $start_day = date("d", strtotime($start_time));
                                $start_month = date("m", strtotime($start_time));
                                $end_day = date("d", strtotime($end_time));
                                $end_month = date("m", strtotime($end_time));
                                $s = strtotime($start_time);
                                $e = strtotime($end_time);
                                $i = 0;
                                $num = 0;
                                while ($s <= $e) {

                                $time[$i] = date("d", $s);
                                $s = $s + 86400;
                                //echo "i".$time[$i]."<br>";
                                $i++;
                                $num++;
                                //echo "nuddd".$num."<br>";

                                }

                                //echo "nuddd".$num;

                                for ($i = 0; $i < $num; $i++) {
                                $business [$i] = 0;
                                }
                                for ($j = 0; $j < $num; $j++) {
                                $side[$j] = 0;
                                }
                                for ($h = 0; $h < $num; $h++) {
                                $private [$h] = 0;
                                }
                                for ($h = 0; $h < $num; $h++) {
                                $total [$h] = 0;
                                }
                                //echo"fse".$end_time;
                                $as = strtotime($start_time);
                                $ae = strtotime($end_time) + 86400;
                                $resut_btime = M()->query //商业车厂(1)查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=1
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>=$as
                                AND px_parkrecord.start_time<=$ae
                                AND px_parkrecord.park_id=$park_id
                                ORDER BY start_time asc ");
                                for ($j = 0; $j < count($resut_btime); $j++) {
                                $d = date('Y-m-d', $resut_btime [$j] ['start_time']);

                                $dd = strtotime(date('Y-m-d', $as));
                                $ns = (int)((strtotime($d) - $dd) / 86400);
                                $business[$ns] = $business[$ns] + 1;
                                $total[$ns] = $total[$ns] + 1;
                                }

                                $resut_stime = M()->query //路测车厂(2)查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=2
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>=$as
                                AND px_parkrecord.start_time<=$ae
                                AND px_parkrecord.park_id=$park_id
                                ORDER BY start_time asc ");
                                //echo "uoo".count( $resut_stime );
                                for ($j = 0; $j < count($resut_stime); $j++) {
                                $d = date('Y-m-d', $resut_stime [$j] ['start_time']);

                                $dd = strtotime(date('Y-m-d', $as));
                                $ns = (int)((strtotime($d) - $dd) / 86400);
                                $side[$ns] = $side[$ns] + 1;
                                $total[$ns] = $total[$ns] + 1;
                                }

                                $resut_ptime = M()->query //路测车厂(2)查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=3
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>=$as
                                AND px_parkrecord.start_time<=$ae
                                AND px_parkrecord.park_id=$park_id
                                ORDER BY start_time asc ");
                                /* echo "as".$as;
                                echo "ae".$ae;
                                echo "uu".count( $resut_ptime ); */
                                for ($j = 0; $j < count($resut_ptime); $j++) {
                                $d = date('Y-m-d', $resut_ptime [$j] ['start_time']);
                                $dd = strtotime(date('Y-m-d', $as));
                                $ns = (int)((strtotime($d) - $dd) / 86400);
                                $private[$ns] = $private[$ns] + 1;
                                $total[$ns] = $total[$ns] + 1;
                                // echo "dd".$private[$ns];
                                }

                                $array = array(
                                "time" => $time,
                                "business" => $business,
                                "side" => $side,
                                "private" => $private,
                                "total" => $total,
                                );

                                echo json_encode($array);

                                }
                                }


                                }
                            </li>
                            <li>
                                $park_id = 0;//所有停车厂

                                $t = I('post.time');

                                $start_time = I('post.start_time');
                                $end_time = I('post.end_time');

                                //echo $start_time;
                                $now = strtotime("now ");

                                $cout_start;
                                $cut_time = $now - $t * 60 * 60;
                                $now_h = date("H", $now) + 1;

                                if ($park_id == 0) {
                                if ($t == 24) {
                                for ($i = 0; $i < 24; $i++) {
                                $business [$i] = 0;
                                }
                                for ($j = 0; $j < 24; $j++) {
                                $side[$j] = 0;
                                }
                                for ($h = 0; $h < 24; $h++) {
                                $private [$h] = 0;
                                }
                                for ($h = 0; $h < 24; $h++) {
                                $total [$h] = 0;
                                }
                                $p = 0;
                                $n = $now_h - 1;
                                // $cut_time = $now - $time * 60 * 60;
                                for ($h = 23; $h >= 0; $h--) {

                                if ($n - $p >= 0)
                                $ti[$h] = $n - $p;
                                else
                                $ti[$h] = $n - $p + 24;
                                $p++;

                                }
                                for ($j = 0; $j < 24; $j++) {
                                $time[$j] = $ti[$j] . ":00";

                                }
                                // sort($time);
                                $resut_btime = M()->query //商业车厂(1)查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=1
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>$cut_time
                                ORDER BY start_time asc ");

                                for ($i = 0; $i < count($resut_btime); $i++) {
                                $shour = date("H", $resut_btime [$i] ['start_time']);
                                if ($shour > $now_h)
                                $num = $shour - $now_h;
                                else {
                                $num = $shour - $now_h + 24;
                                }

                                $business[$num] = $business[$num] + 1;
                                $total[$num] = $total[$num] + 1;
                                }
                                $resut_stime = M()->query //路测（2）车厂查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=2
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>$cut_time
                                ORDER BY start_time asc ");
                                //echo "f".count ( $resut_stime );
                                for ($i = 0; $i < count($resut_stime); $i++) {
                                $shour = date("H", $resut_stime [$i] ['start_time']);
                                if ($shour > $now_h)
                                $num = $shour - $now_h;
                                else {
                                $num = $shour - $now_h + 24;
                                }

                                $side[$num] = $side[$num] + 1;
                                $total[$num] = $total[$num] + 1;
                                }

                                $resut_ptime = M()->query //私家车（3）车厂查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=3
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>$cut_time
                                ORDER BY start_time asc ");

                                for ($i = 0; $i < count($resut_ptime); $i++) {
                                $shour = date("H", $resut_ptime [$i] ['start_time']);
                                if ($shour > $now_h)
                                $num = $shour - $now_h;
                                else {
                                $num = $shour - $now_h + 24;
                                }

                                $private[$num] = $private[$num] + 1;
                                $total[$num] = $total[$num] + 1;

                                }
                                // echo "".$cut_time;
                                //print_r($business);

                                $array = array(
                                "time" => $time,
                                "business" => $business,
                                "side" => $side,
                                "private" => $private,
                                "total" => $total,
                                );

                                echo json_encode($array);
                                }
                                if ($start_time) {
                                //echo "fse";
                                $start_day = date("d", strtotime($start_time));
                                $start_month = date("m", strtotime($start_time));
                                $end_day = date("d", strtotime($end_time));
                                $end_month = date("m", strtotime($end_time));
                                $s = strtotime($start_time);
                                $e = strtotime($end_time);
                                $i = 0;
                                $num = 0;
                                while ($s <= $e) {

                                $time[$i] = date("d", $s);
                                $s = $s + 86400;
                                // echo "i".$time[$i]."<br>";
                                $i++;
                                $num++;
                                //echo "nuddd".$num."<br>";

                                }

                                //echo "nuddd".$num;

                                for ($i = 0; $i < $num; $i++) {
                                $business [$i] = 0;
                                }
                                for ($j = 0; $j < $num; $j++) {
                                $side[$j] = 0;
                                }
                                for ($h = 0; $h < $num; $h++) {
                                $private [$h] = 0;
                                }
                                for ($h = 0; $h < $num; $h++) {
                                $total [$h] = 0;
                                }
                                //echo"fse".$end_time;
                                $as = strtotime($start_time);
                                $ae = strtotime($end_time) + 86400;
                                $resut_btime = M()->query //商业车厂(1)查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=1
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>=$as
                                AND px_parkrecord.start_time<=$ae
                                ORDER BY start_time asc ");
                                for ($j = 0; $j < count($resut_btime); $j++) {
                                $d = date('Y-m-d', $resut_btime [$j] ['start_time']);

                                $dd = strtotime(date('Y-m-d', $as));
                                $ns = (int)((strtotime($d) - $dd) / 86400);
                                $business[$ns] = $business[$ns] + 1;
                                $total[$ns] = $total[$ns] + 1;
                                }

                                $resut_stime = M()->query //路测车厂(2)查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=2
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>=$as
                                AND px_parkrecord.start_time<=$ae
                                ORDER BY start_time asc ");
                                //echo "uoo".count( $resut_stime );
                                for ($j = 0; $j < count($resut_stime); $j++) {
                                $d = date('Y-m-d', $resut_stime [$j] ['start_time']);

                                $ns = (int)((strtotime($d) - $dd) / 86400);
                                $side[$ns] = $side[$ns] + 1;
                                $total[$ns] = $total[$ns] + 1;
                                }

                                $resut_ptime = M()->query //私人车厂(3)查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=3
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>=$as
                                AND px_parkrecord.start_time<=$ae
                                ORDER BY start_time asc ");

                                /* echo "as".$as;
                                echo "ae".$ae;
                                echo "uu".count( $resut_ptime ); */
                                for ($j = 0; $j < count($resut_ptime); $j++) {
                                $d = date('Y-m-d', $resut_ptime [$j] ['start_time']);
                                $dd = strtotime(date('Y-m-d', $as));
                                $ns = (int)((strtotime($d) - $dd) / 86400);
                                $private[$ns] = $private[$ns] + 1;
                                $total[$ns] = $total[$ns] + 1;
                                // echo "dd".$private[$ns];
                                }

                                $array = array(
                                "time" => $time,
                                "business" => $business,
                                "side" => $side,
                                "private" => $private,
                                "total" => $total,
                                );

                                echo json_encode($array);

                                }
                                } else {
                                if ($t == 24) {
                                for ($i = 0; $i < 24; $i++) {
                                $business [$i] = 0;
                                }
                                for ($j = 0; $j < 24; $j++) {
                                $side[$j] = 0;
                                }
                                for ($h = 0; $h < 24; $h++) {
                                $private [$h] = 0;
                                }
                                for ($h = 0; $h < 24; $h++) {
                                $total [$h] = 0;
                                }
                                $p = 0;
                                $n = $now_h - 1;
                                // $cut_time = $now - $time * 60 * 60;
                                for ($h = 23; $h >= 0; $h--) {

                                if ($n - $p >= 0)
                                $ti[$h] = $n - $p;
                                else
                                $ti[$h] = $n - $p + 24;
                                $p++;

                                }
                                for ($j = 0; $j < 24; $j++) {
                                $time[$j] = $ti[$j];

                                }
                                // sort($time);
                                $resut_btime = M()->query //商业车厂(1)查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=1
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>$cut_time
                                AND px_parkrecord.park_id=$park_id
                                ORDER BY start_time asc ");

                                for ($i = 0; $i < count($resut_btime); $i++) {
                                $shour = date("H", $resut_btime [$i] ['start_time']);
                                if ($shour > $now_h)
                                $num = $shour - $now_h;
                                else {
                                $num = $shour - $now_h + 24;
                                }

                                $business[$num] = $business[$num] + 1;
                                $total[$num] = $total[$num] + 1;
                                // echo "shour" . $shour . "<br>";
                                // echo "num" . $num . "<br>";
                                // echo "svalue" . $in [abs ( $now_h - $shour )] . "<br>";
                                }


                                $resut_stime = M()->query //路测（2）车厂查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=2
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>$cut_time
                                AND px_parkrecord.park_id=$park_id
                                ORDER BY start_time asc ");

                                for ($i = 0; $i < count($resut_stime); $i++) {
                                $shour = date("H", $resut_stime [$i] ['start_time']);
                                if ($shour > $now_h)
                                $num = $shour - $now_h;
                                else {
                                $num = $shour - $now_h + 24;
                                }

                                $side[$num] = $side[$num] + 1;
                                $total[$num] = $total[$num] + 1;
                                // echo "shour" . $shour . "<br>";
                                // echo "num" . $num . "<br>";
                                // echo "svalue" . $in [abs ( $now_h - $shour )] . "<br>";
                                }

                                $resut_ptime = M()->query //私家车（3）车厂查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=3
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>$cut_time
                                AND px_parkrecord.park_id=$park_id
                                ORDER BY start_time asc ");

                                for ($i = 0; $i < count($resut_ptime); $i++) {
                                $shour = date("H", $resut_ptime [$i] ['start_time']);
                                if ($shour > $now_h)
                                $num = $shour - $now_h;
                                else {
                                $num = $shour - $now_h + 24;
                                }

                                $private[$num] = $private[$num] + 1;
                                $total[$num] = $total[$num] + 1;

                                }
                                //echo "".$cut_time;
                                //print_r($business);

                                $array = array(
                                "time" => $time,
                                "business" => $business,
                                "side" => $side,
                                "private" => $private,
                                "total" => $total,
                                );
                                /* $d=strtotime('2015-7-2');
                                $as=strtotime('2015-7-1');
                                echo "ffffffffff".$d;
                                $ns=(int)(($d-$as)/86400);
                                echo "d".$ns;*/
                                echo json_encode($array);
                                }
                                if ($start_time) {
                                $start_day = date("d", strtotime($start_time));
                                $start_month = date("m", strtotime($start_time));
                                $end_day = date("d", strtotime($end_time));
                                $end_month = date("m", strtotime($end_time));
                                $s = strtotime($start_time);
                                $e = strtotime($end_time);
                                $i = 0;
                                $num = 0;
                                while ($s <= $e) {

                                $time[$i] = date("d", $s);
                                $s = $s + 86400;
                                //echo "i".$time[$i]."<br>";
                                $i++;
                                $num++;
                                //echo "nuddd".$num."<br>";

                                }

                                //echo "nuddd".$num;

                                for ($i = 0; $i < $num; $i++) {
                                $business [$i] = 0;
                                }
                                for ($j = 0; $j < $num; $j++) {
                                $side[$j] = 0;
                                }
                                for ($h = 0; $h < $num; $h++) {
                                $private [$h] = 0;
                                }
                                for ($h = 0; $h < $num; $h++) {
                                $total [$h] = 0;
                                }
                                //echo"fse".$end_time;
                                $as = strtotime($start_time);
                                $ae = strtotime($end_time) + 86400;
                                $resut_btime = M()->query //商业车厂(1)查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=1
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>=$as
                                AND px_parkrecord.start_time<=$ae
                                AND px_parkrecord.park_id=$park_id
                                ORDER BY start_time asc ");
                                for ($j = 0; $j < count($resut_btime); $j++) {
                                $d = date('Y-m-d', $resut_btime [$j] ['start_time']);

                                $dd = strtotime(date('Y-m-d', $as));
                                $ns = (int)((strtotime($d) - $dd) / 86400);
                                $business[$ns] = $business[$ns] + 1;
                                $total[$ns] = $total[$ns] + 1;
                                }

                                $resut_stime = M()->query //路测车厂(2)查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=2
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>=$as
                                AND px_parkrecord.start_time<=$ae
                                AND px_parkrecord.park_id=$park_id
                                ORDER BY start_time asc ");
                                //echo "uoo".count( $resut_stime );
                                for ($j = 0; $j < count($resut_stime); $j++) {
                                $d = date('Y-m-d', $resut_stime [$j] ['start_time']);

                                $dd = strtotime(date('Y-m-d', $as));
                                $ns = (int)((strtotime($d) - $dd) / 86400);
                                $side[$ns] = $side[$ns] + 1;
                                $total[$ns] = $total[$ns] + 1;
                                }

                                $resut_ptime = M()->query //路测车厂(2)查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=3
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>=$as
                                AND px_parkrecord.start_time<=$ae
                                AND px_parkrecord.park_id=$park_id
                                ORDER BY start_time asc ");
                                /* echo "as".$as;
                                echo "ae".$ae;
                                echo "uu".count( $resut_ptime ); */
                                for ($j = 0; $j < count($resut_ptime); $j++) {
                                $d = date('Y-m-d', $resut_ptime [$j] ['start_time']);
                                $dd = strtotime(date('Y-m-d', $as));
                                $ns = (int)((strtotime($d) - $dd) / 86400);
                                $private[$ns] = $private[$ns] + 1;
                                $total[$ns] = $total[$ns] + 1;
                                // echo "dd".$private[$ns];
                                }

                                $array = array(
                                "time" => $time,
                                "business" => $business,
                                "side" => $side,
                                "private" => $private,
                                "total" => $total,
                                );

                                echo json_encode($array);

                                }
                                }


                                }
                            </li>
                            <li>
                                $park_id = 0;//所有停车厂

                                $t = I('post.time');

                                $start_time = I('post.start_time');
                                $end_time = I('post.end_time');

                                //echo $start_time;
                                $now = strtotime("now ");

                                $cout_start;
                                $cut_time = $now - $t * 60 * 60;
                                $now_h = date("H", $now) + 1;

                                if ($park_id == 0) {
                                if ($t == 24) {
                                for ($i = 0; $i < 24; $i++) {
                                $business [$i] = 0;
                                }
                                for ($j = 0; $j < 24; $j++) {
                                $side[$j] = 0;
                                }
                                for ($h = 0; $h < 24; $h++) {
                                $private [$h] = 0;
                                }
                                for ($h = 0; $h < 24; $h++) {
                                $total [$h] = 0;
                                }
                                $p = 0;
                                $n = $now_h - 1;
                                // $cut_time = $now - $time * 60 * 60;
                                for ($h = 23; $h >= 0; $h--) {

                                if ($n - $p >= 0)
                                $ti[$h] = $n - $p;
                                else
                                $ti[$h] = $n - $p + 24;
                                $p++;

                                }
                                for ($j = 0; $j < 24; $j++) {
                                $time[$j] = $ti[$j] . ":00";

                                }
                                // sort($time);
                                $resut_btime = M()->query //商业车厂(1)查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=1
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>$cut_time
                                ORDER BY start_time asc ");

                                for ($i = 0; $i < count($resut_btime); $i++) {
                                $shour = date("H", $resut_btime [$i] ['start_time']);
                                if ($shour > $now_h)
                                $num = $shour - $now_h;
                                else {
                                $num = $shour - $now_h + 24;
                                }

                                $business[$num] = $business[$num] + 1;
                                $total[$num] = $total[$num] + 1;
                                }
                                $resut_stime = M()->query //路测（2）车厂查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=2
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>$cut_time
                                ORDER BY start_time asc ");
                                //echo "f".count ( $resut_stime );
                                for ($i = 0; $i < count($resut_stime); $i++) {
                                $shour = date("H", $resut_stime [$i] ['start_time']);
                                if ($shour > $now_h)
                                $num = $shour - $now_h;
                                else {
                                $num = $shour - $now_h + 24;
                                }

                                $side[$num] = $side[$num] + 1;
                                $total[$num] = $total[$num] + 1;
                                }

                                $resut_ptime = M()->query //私家车（3）车厂查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=3
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>$cut_time
                                ORDER BY start_time asc ");

                                for ($i = 0; $i < count($resut_ptime); $i++) {
                                $shour = date("H", $resut_ptime [$i] ['start_time']);
                                if ($shour > $now_h)
                                $num = $shour - $now_h;
                                else {
                                $num = $shour - $now_h + 24;
                                }

                                $private[$num] = $private[$num] + 1;
                                $total[$num] = $total[$num] + 1;

                                }
                                // echo "".$cut_time;
                                //print_r($business);

                                $array = array(
                                "time" => $time,
                                "business" => $business,
                                "side" => $side,
                                "private" => $private,
                                "total" => $total,
                                );

                                echo json_encode($array);
                                }
                                if ($start_time) {
                                //echo "fse";
                                $start_day = date("d", strtotime($start_time));
                                $start_month = date("m", strtotime($start_time));
                                $end_day = date("d", strtotime($end_time));
                                $end_month = date("m", strtotime($end_time));
                                $s = strtotime($start_time);
                                $e = strtotime($end_time);
                                $i = 0;
                                $num = 0;
                                while ($s <= $e) {

                                $time[$i] = date("d", $s);
                                $s = $s + 86400;
                                // echo "i".$time[$i]."<br>";
                                $i++;
                                $num++;
                                //echo "nuddd".$num."<br>";

                                }

                                //echo "nuddd".$num;

                                for ($i = 0; $i < $num; $i++) {
                                $business [$i] = 0;
                                }
                                for ($j = 0; $j < $num; $j++) {
                                $side[$j] = 0;
                                }
                                for ($h = 0; $h < $num; $h++) {
                                $private [$h] = 0;
                                }
                                for ($h = 0; $h < $num; $h++) {
                                $total [$h] = 0;
                                }
                                //echo"fse".$end_time;
                                $as = strtotime($start_time);
                                $ae = strtotime($end_time) + 86400;
                                $resut_btime = M()->query //商业车厂(1)查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=1
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>=$as
                                AND px_parkrecord.start_time<=$ae
                                ORDER BY start_time asc ");
                                for ($j = 0; $j < count($resut_btime); $j++) {
                                $d = date('Y-m-d', $resut_btime [$j] ['start_time']);

                                $dd = strtotime(date('Y-m-d', $as));
                                $ns = (int)((strtotime($d) - $dd) / 86400);
                                $business[$ns] = $business[$ns] + 1;
                                $total[$ns] = $total[$ns] + 1;
                                }

                                $resut_stime = M()->query //路测车厂(2)查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=2
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>=$as
                                AND px_parkrecord.start_time<=$ae
                                ORDER BY start_time asc ");
                                //echo "uoo".count( $resut_stime );
                                for ($j = 0; $j < count($resut_stime); $j++) {
                                $d = date('Y-m-d', $resut_stime [$j] ['start_time']);

                                $ns = (int)((strtotime($d) - $dd) / 86400);
                                $side[$ns] = $side[$ns] + 1;
                                $total[$ns] = $total[$ns] + 1;
                                }

                                $resut_ptime = M()->query //私人车厂(3)查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=3
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>=$as
                                AND px_parkrecord.start_time<=$ae
                                ORDER BY start_time asc ");

                                /* echo "as".$as;
                                echo "ae".$ae;
                                echo "uu".count( $resut_ptime ); */
                                for ($j = 0; $j < count($resut_ptime); $j++) {
                                $d = date('Y-m-d', $resut_ptime [$j] ['start_time']);
                                $dd = strtotime(date('Y-m-d', $as));
                                $ns = (int)((strtotime($d) - $dd) / 86400);
                                $private[$ns] = $private[$ns] + 1;
                                $total[$ns] = $total[$ns] + 1;
                                // echo "dd".$private[$ns];
                                }

                                $array = array(
                                "time" => $time,
                                "business" => $business,
                                "side" => $side,
                                "private" => $private,
                                "total" => $total,
                                );

                                echo json_encode($array);

                                }
                                } else {
                                if ($t == 24) {
                                for ($i = 0; $i < 24; $i++) {
                                $business [$i] = 0;
                                }
                                for ($j = 0; $j < 24; $j++) {
                                $side[$j] = 0;
                                }
                                for ($h = 0; $h < 24; $h++) {
                                $private [$h] = 0;
                                }
                                for ($h = 0; $h < 24; $h++) {
                                $total [$h] = 0;
                                }
                                $p = 0;
                                $n = $now_h - 1;
                                // $cut_time = $now - $time * 60 * 60;
                                for ($h = 23; $h >= 0; $h--) {

                                if ($n - $p >= 0)
                                $ti[$h] = $n - $p;
                                else
                                $ti[$h] = $n - $p + 24;
                                $p++;

                                }
                                for ($j = 0; $j < 24; $j++) {
                                $time[$j] = $ti[$j];

                                }
                                // sort($time);
                                $resut_btime = M()->query //商业车厂(1)查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=1
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>$cut_time
                                AND px_parkrecord.park_id=$park_id
                                ORDER BY start_time asc ");

                                for ($i = 0; $i < count($resut_btime); $i++) {
                                $shour = date("H", $resut_btime [$i] ['start_time']);
                                if ($shour > $now_h)
                                $num = $shour - $now_h;
                                else {
                                $num = $shour - $now_h + 24;
                                }

                                $business[$num] = $business[$num] + 1;
                                $total[$num] = $total[$num] + 1;
                                // echo "shour" . $shour . "<br>";
                                // echo "num" . $num . "<br>";
                                // echo "svalue" . $in [abs ( $now_h - $shour )] . "<br>";
                                }


                                $resut_stime = M()->query //路测（2）车厂查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=2
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>$cut_time
                                AND px_parkrecord.park_id=$park_id
                                ORDER BY start_time asc ");

                                for ($i = 0; $i < count($resut_stime); $i++) {
                                $shour = date("H", $resut_stime [$i] ['start_time']);
                                if ($shour > $now_h)
                                $num = $shour - $now_h;
                                else {
                                $num = $shour - $now_h + 24;
                                }

                                $side[$num] = $side[$num] + 1;
                                $total[$num] = $total[$num] + 1;
                                // echo "shour" . $shour . "<br>";
                                // echo "num" . $num . "<br>";
                                // echo "svalue" . $in [abs ( $now_h - $shour )] . "<br>";
                                }

                                $resut_ptime = M()->query //私家车（3）车厂查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=3
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>$cut_time
                                AND px_parkrecord.park_id=$park_id
                                ORDER BY start_time asc ");

                                for ($i = 0; $i < count($resut_ptime); $i++) {
                                $shour = date("H", $resut_ptime [$i] ['start_time']);
                                if ($shour > $now_h)
                                $num = $shour - $now_h;
                                else {
                                $num = $shour - $now_h + 24;
                                }

                                $private[$num] = $private[$num] + 1;
                                $total[$num] = $total[$num] + 1;

                                }
                                //echo "".$cut_time;
                                //print_r($business);

                                $array = array(
                                "time" => $time,
                                "business" => $business,
                                "side" => $side,
                                "private" => $private,
                                "total" => $total,
                                );
                                /* $d=strtotime('2015-7-2');
                                $as=strtotime('2015-7-1');
                                echo "ffffffffff".$d;
                                $ns=(int)(($d-$as)/86400);
                                echo "d".$ns;*/
                                echo json_encode($array);
                                }
                                if ($start_time) {
                                $start_day = date("d", strtotime($start_time));
                                $start_month = date("m", strtotime($start_time));
                                $end_day = date("d", strtotime($end_time));
                                $end_month = date("m", strtotime($end_time));
                                $s = strtotime($start_time);
                                $e = strtotime($end_time);
                                $i = 0;
                                $num = 0;
                                while ($s <= $e) {

                                $time[$i] = date("d", $s);
                                $s = $s + 86400;
                                //echo "i".$time[$i]."<br>";
                                $i++;
                                $num++;
                                //echo "nuddd".$num."<br>";

                                }

                                //echo "nuddd".$num;

                                for ($i = 0; $i < $num; $i++) {
                                $business [$i] = 0;
                                }
                                for ($j = 0; $j < $num; $j++) {
                                $side[$j] = 0;
                                }
                                for ($h = 0; $h < $num; $h++) {
                                $private [$h] = 0;
                                }
                                for ($h = 0; $h < $num; $h++) {
                                $total [$h] = 0;
                                }
                                //echo"fse".$end_time;
                                $as = strtotime($start_time);
                                $ae = strtotime($end_time) + 86400;
                                $resut_btime = M()->query //商业车厂(1)查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=1
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>=$as
                                AND px_parkrecord.start_time<=$ae
                                AND px_parkrecord.park_id=$park_id
                                ORDER BY start_time asc ");
                                for ($j = 0; $j < count($resut_btime); $j++) {
                                $d = date('Y-m-d', $resut_btime [$j] ['start_time']);

                                $dd = strtotime(date('Y-m-d', $as));
                                $ns = (int)((strtotime($d) - $dd) / 86400);
                                $business[$ns] = $business[$ns] + 1;
                                $total[$ns] = $total[$ns] + 1;
                                }

                                $resut_stime = M()->query //路测车厂(2)查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=2
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>=$as
                                AND px_parkrecord.start_time<=$ae
                                AND px_parkrecord.park_id=$park_id
                                ORDER BY start_time asc ");
                                //echo "uoo".count( $resut_stime );
                                for ($j = 0; $j < count($resut_stime); $j++) {
                                $d = date('Y-m-d', $resut_stime [$j] ['start_time']);

                                $dd = strtotime(date('Y-m-d', $as));
                                $ns = (int)((strtotime($d) - $dd) / 86400);
                                $side[$ns] = $side[$ns] + 1;
                                $total[$ns] = $total[$ns] + 1;
                                }

                                $resut_ptime = M()->query //路测车厂(2)查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=3
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>=$as
                                AND px_parkrecord.start_time<=$ae
                                AND px_parkrecord.park_id=$park_id
                                ORDER BY start_time asc ");
                                /* echo "as".$as;
                                echo "ae".$ae;
                                echo "uu".count( $resut_ptime ); */
                                for ($j = 0; $j < count($resut_ptime); $j++) {
                                $d = date('Y-m-d', $resut_ptime [$j] ['start_time']);
                                $dd = strtotime(date('Y-m-d', $as));
                                $ns = (int)((strtotime($d) - $dd) / 86400);
                                $private[$ns] = $private[$ns] + 1;
                                $total[$ns] = $total[$ns] + 1;
                                // echo "dd".$private[$ns];
                                }

                                $array = array(
                                "time" => $time,
                                "business" => $business,
                                "side" => $side,
                                "private" => $private,
                                "total" => $total,
                                );

                                echo json_encode($array);

                                }
                                }


                                }
                            </li>
                            <li>
                                $park_id = 0;//所有停车厂

                                $t = I('post.time');

                                $start_time = I('post.start_time');
                                $end_time = I('post.end_time');

                                //echo $start_time;
                                $now = strtotime("now ");

                                $cout_start;
                                $cut_time = $now - $t * 60 * 60;
                                $now_h = date("H", $now) + 1;

                                if ($park_id == 0) {
                                if ($t == 24) {
                                for ($i = 0; $i < 24; $i++) {
                                $business [$i] = 0;
                                }
                                for ($j = 0; $j < 24; $j++) {
                                $side[$j] = 0;
                                }
                                for ($h = 0; $h < 24; $h++) {
                                $private [$h] = 0;
                                }
                                for ($h = 0; $h < 24; $h++) {
                                $total [$h] = 0;
                                }
                                $p = 0;
                                $n = $now_h - 1;
                                // $cut_time = $now - $time * 60 * 60;
                                for ($h = 23; $h >= 0; $h--) {

                                if ($n - $p >= 0)
                                $ti[$h] = $n - $p;
                                else
                                $ti[$h] = $n - $p + 24;
                                $p++;

                                }
                                for ($j = 0; $j < 24; $j++) {
                                $time[$j] = $ti[$j] . ":00";

                                }
                                // sort($time);
                                $resut_btime = M()->query //商业车厂(1)查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=1
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>$cut_time
                                ORDER BY start_time asc ");

                                for ($i = 0; $i < count($resut_btime); $i++) {
                                $shour = date("H", $resut_btime [$i] ['start_time']);
                                if ($shour > $now_h)
                                $num = $shour - $now_h;
                                else {
                                $num = $shour - $now_h + 24;
                                }

                                $business[$num] = $business[$num] + 1;
                                $total[$num] = $total[$num] + 1;
                                }
                                $resut_stime = M()->query //路测（2）车厂查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=2
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>$cut_time
                                ORDER BY start_time asc ");
                                //echo "f".count ( $resut_stime );
                                for ($i = 0; $i < count($resut_stime); $i++) {
                                $shour = date("H", $resut_stime [$i] ['start_time']);
                                if ($shour > $now_h)
                                $num = $shour - $now_h;
                                else {
                                $num = $shour - $now_h + 24;
                                }

                                $side[$num] = $side[$num] + 1;
                                $total[$num] = $total[$num] + 1;
                                }

                                $resut_ptime = M()->query //私家车（3）车厂查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=3
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>$cut_time
                                ORDER BY start_time asc ");

                                for ($i = 0; $i < count($resut_ptime); $i++) {
                                $shour = date("H", $resut_ptime [$i] ['start_time']);
                                if ($shour > $now_h)
                                $num = $shour - $now_h;
                                else {
                                $num = $shour - $now_h + 24;
                                }

                                $private[$num] = $private[$num] + 1;
                                $total[$num] = $total[$num] + 1;

                                }
                                // echo "".$cut_time;
                                //print_r($business);

                                $array = array(
                                "time" => $time,
                                "business" => $business,
                                "side" => $side,
                                "private" => $private,
                                "total" => $total,
                                );

                                echo json_encode($array);
                                }
                                if ($start_time) {
                                //echo "fse";
                                $start_day = date("d", strtotime($start_time));
                                $start_month = date("m", strtotime($start_time));
                                $end_day = date("d", strtotime($end_time));
                                $end_month = date("m", strtotime($end_time));
                                $s = strtotime($start_time);
                                $e = strtotime($end_time);
                                $i = 0;
                                $num = 0;
                                while ($s <= $e) {

                                $time[$i] = date("d", $s);
                                $s = $s + 86400;
                                // echo "i".$time[$i]."<br>";
                                $i++;
                                $num++;
                                //echo "nuddd".$num."<br>";

                                }

                                //echo "nuddd".$num;

                                for ($i = 0; $i < $num; $i++) {
                                $business [$i] = 0;
                                }
                                for ($j = 0; $j < $num; $j++) {
                                $side[$j] = 0;
                                }
                                for ($h = 0; $h < $num; $h++) {
                                $private [$h] = 0;
                                }
                                for ($h = 0; $h < $num; $h++) {
                                $total [$h] = 0;
                                }
                                //echo"fse".$end_time;
                                $as = strtotime($start_time);
                                $ae = strtotime($end_time) + 86400;
                                $resut_btime = M()->query //商业车厂(1)查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=1
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>=$as
                                AND px_parkrecord.start_time<=$ae
                                ORDER BY start_time asc ");
                                for ($j = 0; $j < count($resut_btime); $j++) {
                                $d = date('Y-m-d', $resut_btime [$j] ['start_time']);

                                $dd = strtotime(date('Y-m-d', $as));
                                $ns = (int)((strtotime($d) - $dd) / 86400);
                                $business[$ns] = $business[$ns] + 1;
                                $total[$ns] = $total[$ns] + 1;
                                }

                                $resut_stime = M()->query //路测车厂(2)查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=2
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>=$as
                                AND px_parkrecord.start_time<=$ae
                                ORDER BY start_time asc ");
                                //echo "uoo".count( $resut_stime );
                                for ($j = 0; $j < count($resut_stime); $j++) {
                                $d = date('Y-m-d', $resut_stime [$j] ['start_time']);

                                $ns = (int)((strtotime($d) - $dd) / 86400);
                                $side[$ns] = $side[$ns] + 1;
                                $total[$ns] = $total[$ns] + 1;
                                }

                                $resut_ptime = M()->query //私人车厂(3)查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=3
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>=$as
                                AND px_parkrecord.start_time<=$ae
                                ORDER BY start_time asc ");

                                /* echo "as".$as;
                                echo "ae".$ae;
                                echo "uu".count( $resut_ptime ); */
                                for ($j = 0; $j < count($resut_ptime); $j++) {
                                $d = date('Y-m-d', $resut_ptime [$j] ['start_time']);
                                $dd = strtotime(date('Y-m-d', $as));
                                $ns = (int)((strtotime($d) - $dd) / 86400);
                                $private[$ns] = $private[$ns] + 1;
                                $total[$ns] = $total[$ns] + 1;
                                // echo "dd".$private[$ns];
                                }

                                $array = array(
                                "time" => $time,
                                "business" => $business,
                                "side" => $side,
                                "private" => $private,
                                "total" => $total,
                                );

                                echo json_encode($array);

                                }
                                } else {
                                if ($t == 24) {
                                for ($i = 0; $i < 24; $i++) {
                                $business [$i] = 0;
                                }
                                for ($j = 0; $j < 24; $j++) {
                                $side[$j] = 0;
                                }
                                for ($h = 0; $h < 24; $h++) {
                                $private [$h] = 0;
                                }
                                for ($h = 0; $h < 24; $h++) {
                                $total [$h] = 0;
                                }
                                $p = 0;
                                $n = $now_h - 1;
                                // $cut_time = $now - $time * 60 * 60;
                                for ($h = 23; $h >= 0; $h--) {

                                if ($n - $p >= 0)
                                $ti[$h] = $n - $p;
                                else
                                $ti[$h] = $n - $p + 24;
                                $p++;

                                }
                                for ($j = 0; $j < 24; $j++) {
                                $time[$j] = $ti[$j];

                                }
                                // sort($time);
                                $resut_btime = M()->query //商业车厂(1)查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=1
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>$cut_time
                                AND px_parkrecord.park_id=$park_id
                                ORDER BY start_time asc ");

                                for ($i = 0; $i < count($resut_btime); $i++) {
                                $shour = date("H", $resut_btime [$i] ['start_time']);
                                if ($shour > $now_h)
                                $num = $shour - $now_h;
                                else {
                                $num = $shour - $now_h + 24;
                                }

                                $business[$num] = $business[$num] + 1;
                                $total[$num] = $total[$num] + 1;
                                // echo "shour" . $shour . "<br>";
                                // echo "num" . $num . "<br>";
                                // echo "svalue" . $in [abs ( $now_h - $shour )] . "<br>";
                                }


                                $resut_stime = M()->query //路测（2）车厂查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=2
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>$cut_time
                                AND px_parkrecord.park_id=$park_id
                                ORDER BY start_time asc ");

                                for ($i = 0; $i < count($resut_stime); $i++) {
                                $shour = date("H", $resut_stime [$i] ['start_time']);
                                if ($shour > $now_h)
                                $num = $shour - $now_h;
                                else {
                                $num = $shour - $now_h + 24;
                                }

                                $side[$num] = $side[$num] + 1;
                                $total[$num] = $total[$num] + 1;
                                // echo "shour" . $shour . "<br>";
                                // echo "num" . $num . "<br>";
                                // echo "svalue" . $in [abs ( $now_h - $shour )] . "<br>";
                                }

                                $resut_ptime = M()->query //私家车（3）车厂查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=3
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>$cut_time
                                AND px_parkrecord.park_id=$park_id
                                ORDER BY start_time asc ");

                                for ($i = 0; $i < count($resut_ptime); $i++) {
                                $shour = date("H", $resut_ptime [$i] ['start_time']);
                                if ($shour > $now_h)
                                $num = $shour - $now_h;
                                else {
                                $num = $shour - $now_h + 24;
                                }

                                $private[$num] = $private[$num] + 1;
                                $total[$num] = $total[$num] + 1;

                                }
                                //echo "".$cut_time;
                                //print_r($business);

                                $array = array(
                                "time" => $time,
                                "business" => $business,
                                "side" => $side,
                                "private" => $private,
                                "total" => $total,
                                );
                                /* $d=strtotime('2015-7-2');
                                $as=strtotime('2015-7-1');
                                echo "ffffffffff".$d;
                                $ns=(int)(($d-$as)/86400);
                                echo "d".$ns;*/
                                echo json_encode($array);
                                }
                                if ($start_time) {
                                $start_day = date("d", strtotime($start_time));
                                $start_month = date("m", strtotime($start_time));
                                $end_day = date("d", strtotime($end_time));
                                $end_month = date("m", strtotime($end_time));
                                $s = strtotime($start_time);
                                $e = strtotime($end_time);
                                $i = 0;
                                $num = 0;
                                while ($s <= $e) {

                                $time[$i] = date("d", $s);
                                $s = $s + 86400;
                                //echo "i".$time[$i]."<br>";
                                $i++;
                                $num++;
                                //echo "nuddd".$num."<br>";

                                }

                                //echo "nuddd".$num;

                                for ($i = 0; $i < $num; $i++) {
                                $business [$i] = 0;
                                }
                                for ($j = 0; $j < $num; $j++) {
                                $side[$j] = 0;
                                }
                                for ($h = 0; $h < $num; $h++) {
                                $private [$h] = 0;
                                }
                                for ($h = 0; $h < $num; $h++) {
                                $total [$h] = 0;
                                }
                                //echo"fse".$end_time;
                                $as = strtotime($start_time);
                                $ae = strtotime($end_time) + 86400;
                                $resut_btime = M()->query //商业车厂(1)查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=1
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>=$as
                                AND px_parkrecord.start_time<=$ae
                                AND px_parkrecord.park_id=$park_id
                                ORDER BY start_time asc ");
                                for ($j = 0; $j < count($resut_btime); $j++) {
                                $d = date('Y-m-d', $resut_btime [$j] ['start_time']);

                                $dd = strtotime(date('Y-m-d', $as));
                                $ns = (int)((strtotime($d) - $dd) / 86400);
                                $business[$ns] = $business[$ns] + 1;
                                $total[$ns] = $total[$ns] + 1;
                                }

                                $resut_stime = M()->query //路测车厂(2)查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=2
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>=$as
                                AND px_parkrecord.start_time<=$ae
                                AND px_parkrecord.park_id=$park_id
                                ORDER BY start_time asc ");
                                //echo "uoo".count( $resut_stime );
                                for ($j = 0; $j < count($resut_stime); $j++) {
                                $d = date('Y-m-d', $resut_stime [$j] ['start_time']);

                                $dd = strtotime(date('Y-m-d', $as));
                                $ns = (int)((strtotime($d) - $dd) / 86400);
                                $side[$ns] = $side[$ns] + 1;
                                $total[$ns] = $total[$ns] + 1;
                                }

                                $resut_ptime = M()->query //路测车厂(2)查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=3
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>=$as
                                AND px_parkrecord.start_time<=$ae
                                AND px_parkrecord.park_id=$park_id
                                ORDER BY start_time asc ");
                                /* echo "as".$as;
                                echo "ae".$ae;
                                echo "uu".count( $resut_ptime ); */
                                for ($j = 0; $j < count($resut_ptime); $j++) {
                                $d = date('Y-m-d', $resut_ptime [$j] ['start_time']);
                                $dd = strtotime(date('Y-m-d', $as));
                                $ns = (int)((strtotime($d) - $dd) / 86400);
                                $private[$ns] = $private[$ns] + 1;
                                $total[$ns] = $total[$ns] + 1;
                                // echo "dd".$private[$ns];
                                }

                                $array = array(
                                "time" => $time,
                                "business" => $business,
                                "side" => $side,
                                "private" => $private,
                                "total" => $total,
                                );

                                echo json_encode($array);

                                }
                                }


                                }
                            </li>
                            <li>
                                $park_id = 0;//所有停车厂

                                $t = I('post.time');

                                $start_time = I('post.start_time');
                                $end_time = I('post.end_time');

                                //echo $start_time;
                                $now = strtotime("now ");

                                $cout_start;
                                $cut_time = $now - $t * 60 * 60;
                                $now_h = date("H", $now) + 1;

                                if ($park_id == 0) {
                                if ($t == 24) {
                                for ($i = 0; $i < 24; $i++) {
                                $business [$i] = 0;
                                }
                                for ($j = 0; $j < 24; $j++) {
                                $side[$j] = 0;
                                }
                                for ($h = 0; $h < 24; $h++) {
                                $private [$h] = 0;
                                }
                                for ($h = 0; $h < 24; $h++) {
                                $total [$h] = 0;
                                }
                                $p = 0;
                                $n = $now_h - 1;
                                // $cut_time = $now - $time * 60 * 60;
                                for ($h = 23; $h >= 0; $h--) {

                                if ($n - $p >= 0)
                                $ti[$h] = $n - $p;
                                else
                                $ti[$h] = $n - $p + 24;
                                $p++;

                                }
                                for ($j = 0; $j < 24; $j++) {
                                $time[$j] = $ti[$j] . ":00";

                                }
                                // sort($time);
                                $resut_btime = M()->query //商业车厂(1)查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=1
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>$cut_time
                                ORDER BY start_time asc ");

                                for ($i = 0; $i < count($resut_btime); $i++) {
                                $shour = date("H", $resut_btime [$i] ['start_time']);
                                if ($shour > $now_h)
                                $num = $shour - $now_h;
                                else {
                                $num = $shour - $now_h + 24;
                                }

                                $business[$num] = $business[$num] + 1;
                                $total[$num] = $total[$num] + 1;
                                }
                                $resut_stime = M()->query //路测（2）车厂查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=2
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>$cut_time
                                ORDER BY start_time asc ");
                                //echo "f".count ( $resut_stime );
                                for ($i = 0; $i < count($resut_stime); $i++) {
                                $shour = date("H", $resut_stime [$i] ['start_time']);
                                if ($shour > $now_h)
                                $num = $shour - $now_h;
                                else {
                                $num = $shour - $now_h + 24;
                                }

                                $side[$num] = $side[$num] + 1;
                                $total[$num] = $total[$num] + 1;
                                }

                                $resut_ptime = M()->query //私家车（3）车厂查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=3
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>$cut_time
                                ORDER BY start_time asc ");

                                for ($i = 0; $i < count($resut_ptime); $i++) {
                                $shour = date("H", $resut_ptime [$i] ['start_time']);
                                if ($shour > $now_h)
                                $num = $shour - $now_h;
                                else {
                                $num = $shour - $now_h + 24;
                                }

                                $private[$num] = $private[$num] + 1;
                                $total[$num] = $total[$num] + 1;

                                }
                                // echo "".$cut_time;
                                //print_r($business);

                                $array = array(
                                "time" => $time,
                                "business" => $business,
                                "side" => $side,
                                "private" => $private,
                                "total" => $total,
                                );

                                echo json_encode($array);
                                }
                                if ($start_time) {
                                //echo "fse";
                                $start_day = date("d", strtotime($start_time));
                                $start_month = date("m", strtotime($start_time));
                                $end_day = date("d", strtotime($end_time));
                                $end_month = date("m", strtotime($end_time));
                                $s = strtotime($start_time);
                                $e = strtotime($end_time);
                                $i = 0;
                                $num = 0;
                                while ($s <= $e) {

                                $time[$i] = date("d", $s);
                                $s = $s + 86400;
                                // echo "i".$time[$i]."<br>";
                                $i++;
                                $num++;
                                //echo "nuddd".$num."<br>";

                                }

                                //echo "nuddd".$num;

                                for ($i = 0; $i < $num; $i++) {
                                $business [$i] = 0;
                                }
                                for ($j = 0; $j < $num; $j++) {
                                $side[$j] = 0;
                                }
                                for ($h = 0; $h < $num; $h++) {
                                $private [$h] = 0;
                                }
                                for ($h = 0; $h < $num; $h++) {
                                $total [$h] = 0;
                                }
                                //echo"fse".$end_time;
                                $as = strtotime($start_time);
                                $ae = strtotime($end_time) + 86400;
                                $resut_btime = M()->query //商业车厂(1)查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=1
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>=$as
                                AND px_parkrecord.start_time<=$ae
                                ORDER BY start_time asc ");
                                for ($j = 0; $j < count($resut_btime); $j++) {
                                $d = date('Y-m-d', $resut_btime [$j] ['start_time']);

                                $dd = strtotime(date('Y-m-d', $as));
                                $ns = (int)((strtotime($d) - $dd) / 86400);
                                $business[$ns] = $business[$ns] + 1;
                                $total[$ns] = $total[$ns] + 1;
                                }

                                $resut_stime = M()->query //路测车厂(2)查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=2
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>=$as
                                AND px_parkrecord.start_time<=$ae
                                ORDER BY start_time asc ");
                                //echo "uoo".count( $resut_stime );
                                for ($j = 0; $j < count($resut_stime); $j++) {
                                $d = date('Y-m-d', $resut_stime [$j] ['start_time']);

                                $ns = (int)((strtotime($d) - $dd) / 86400);
                                $side[$ns] = $side[$ns] + 1;
                                $total[$ns] = $total[$ns] + 1;
                                }

                                $resut_ptime = M()->query //私人车厂(3)查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=3
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>=$as
                                AND px_parkrecord.start_time<=$ae
                                ORDER BY start_time asc ");

                                /* echo "as".$as;
                                echo "ae".$ae;
                                echo "uu".count( $resut_ptime ); */
                                for ($j = 0; $j < count($resut_ptime); $j++) {
                                $d = date('Y-m-d', $resut_ptime [$j] ['start_time']);
                                $dd = strtotime(date('Y-m-d', $as));
                                $ns = (int)((strtotime($d) - $dd) / 86400);
                                $private[$ns] = $private[$ns] + 1;
                                $total[$ns] = $total[$ns] + 1;
                                // echo "dd".$private[$ns];
                                }

                                $array = array(
                                "time" => $time,
                                "business" => $business,
                                "side" => $side,
                                "private" => $private,
                                "total" => $total,
                                );

                                echo json_encode($array);

                                }
                                } else {
                                if ($t == 24) {
                                for ($i = 0; $i < 24; $i++) {
                                $business [$i] = 0;
                                }
                                for ($j = 0; $j < 24; $j++) {
                                $side[$j] = 0;
                                }
                                for ($h = 0; $h < 24; $h++) {
                                $private [$h] = 0;
                                }
                                for ($h = 0; $h < 24; $h++) {
                                $total [$h] = 0;
                                }
                                $p = 0;
                                $n = $now_h - 1;
                                // $cut_time = $now - $time * 60 * 60;
                                for ($h = 23; $h >= 0; $h--) {

                                if ($n - $p >= 0)
                                $ti[$h] = $n - $p;
                                else
                                $ti[$h] = $n - $p + 24;
                                $p++;

                                }
                                for ($j = 0; $j < 24; $j++) {
                                $time[$j] = $ti[$j];

                                }
                                // sort($time);
                                $resut_btime = M()->query //商业车厂(1)查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=1
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>$cut_time
                                AND px_parkrecord.park_id=$park_id
                                ORDER BY start_time asc ");

                                for ($i = 0; $i < count($resut_btime); $i++) {
                                $shour = date("H", $resut_btime [$i] ['start_time']);
                                if ($shour > $now_h)
                                $num = $shour - $now_h;
                                else {
                                $num = $shour - $now_h + 24;
                                }

                                $business[$num] = $business[$num] + 1;
                                $total[$num] = $total[$num] + 1;
                                // echo "shour" . $shour . "<br>";
                                // echo "num" . $num . "<br>";
                                // echo "svalue" . $in [abs ( $now_h - $shour )] . "<br>";
                                }


                                $resut_stime = M()->query //路测（2）车厂查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=2
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>$cut_time
                                AND px_parkrecord.park_id=$park_id
                                ORDER BY start_time asc ");

                                for ($i = 0; $i < count($resut_stime); $i++) {
                                $shour = date("H", $resut_stime [$i] ['start_time']);
                                if ($shour > $now_h)
                                $num = $shour - $now_h;
                                else {
                                $num = $shour - $now_h + 24;
                                }

                                $side[$num] = $side[$num] + 1;
                                $total[$num] = $total[$num] + 1;
                                // echo "shour" . $shour . "<br>";
                                // echo "num" . $num . "<br>";
                                // echo "svalue" . $in [abs ( $now_h - $shour )] . "<br>";
                                }

                                $resut_ptime = M()->query //私家车（3）车厂查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=3
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>$cut_time
                                AND px_parkrecord.park_id=$park_id
                                ORDER BY start_time asc ");

                                for ($i = 0; $i < count($resut_ptime); $i++) {
                                $shour = date("H", $resut_ptime [$i] ['start_time']);
                                if ($shour > $now_h)
                                $num = $shour - $now_h;
                                else {
                                $num = $shour - $now_h + 24;
                                }

                                $private[$num] = $private[$num] + 1;
                                $total[$num] = $total[$num] + 1;

                                }
                                //echo "".$cut_time;
                                //print_r($business);

                                $array = array(
                                "time" => $time,
                                "business" => $business,
                                "side" => $side,
                                "private" => $private,
                                "total" => $total,
                                );
                                /* $d=strtotime('2015-7-2');
                                $as=strtotime('2015-7-1');
                                echo "ffffffffff".$d;
                                $ns=(int)(($d-$as)/86400);
                                echo "d".$ns;*/
                                echo json_encode($array);
                                }
                                if ($start_time) {
                                $start_day = date("d", strtotime($start_time));
                                $start_month = date("m", strtotime($start_time));
                                $end_day = date("d", strtotime($end_time));
                                $end_month = date("m", strtotime($end_time));
                                $s = strtotime($start_time);
                                $e = strtotime($end_time);
                                $i = 0;
                                $num = 0;
                                while ($s <= $e) {

                                $time[$i] = date("d", $s);
                                $s = $s + 86400;
                                //echo "i".$time[$i]."<br>";
                                $i++;
                                $num++;
                                //echo "nuddd".$num."<br>";

                                }

                                //echo "nuddd".$num;

                                for ($i = 0; $i < $num; $i++) {
                                $business [$i] = 0;
                                }
                                for ($j = 0; $j < $num; $j++) {
                                $side[$j] = 0;
                                }
                                for ($h = 0; $h < $num; $h++) {
                                $private [$h] = 0;
                                }
                                for ($h = 0; $h < $num; $h++) {
                                $total [$h] = 0;
                                }
                                //echo"fse".$end_time;
                                $as = strtotime($start_time);
                                $ae = strtotime($end_time) + 86400;
                                $resut_btime = M()->query //商业车厂(1)查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=1
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>=$as
                                AND px_parkrecord.start_time<=$ae
                                AND px_parkrecord.park_id=$park_id
                                ORDER BY start_time asc ");
                                for ($j = 0; $j < count($resut_btime); $j++) {
                                $d = date('Y-m-d', $resut_btime [$j] ['start_time']);

                                $dd = strtotime(date('Y-m-d', $as));
                                $ns = (int)((strtotime($d) - $dd) / 86400);
                                $business[$ns] = $business[$ns] + 1;
                                $total[$ns] = $total[$ns] + 1;
                                }

                                $resut_stime = M()->query //路测车厂(2)查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=2
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>=$as
                                AND px_parkrecord.start_time<=$ae
                                AND px_parkrecord.park_id=$park_id
                                ORDER BY start_time asc ");
                                //echo "uoo".count( $resut_stime );
                                for ($j = 0; $j < count($resut_stime); $j++) {
                                $d = date('Y-m-d', $resut_stime [$j] ['start_time']);

                                $dd = strtotime(date('Y-m-d', $as));
                                $ns = (int)((strtotime($d) - $dd) / 86400);
                                $side[$ns] = $side[$ns] + 1;
                                $total[$ns] = $total[$ns] + 1;
                                }

                                $resut_ptime = M()->query //路测车厂(2)查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=3
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>=$as
                                AND px_parkrecord.start_time<=$ae
                                AND px_parkrecord.park_id=$park_id
                                ORDER BY start_time asc ");
                                /* echo "as".$as;
                                echo "ae".$ae;
                                echo "uu".count( $resut_ptime ); */
                                for ($j = 0; $j < count($resut_ptime); $j++) {
                                $d = date('Y-m-d', $resut_ptime [$j] ['start_time']);
                                $dd = strtotime(date('Y-m-d', $as));
                                $ns = (int)((strtotime($d) - $dd) / 86400);
                                $private[$ns] = $private[$ns] + 1;
                                $total[$ns] = $total[$ns] + 1;
                                // echo "dd".$private[$ns];
                                }

                                $array = array(
                                "time" => $time,
                                "business" => $business,
                                "side" => $side,
                                "private" => $private,
                                "total" => $total,
                                );

                                echo json_encode($array);

                                }
                                }


                                }
                            </li>
                            <li>
                                $park_id = 0;//所有停车厂

                                $t = I('post.time');

                                $start_time = I('post.start_time');
                                $end_time = I('post.end_time');

                                //echo $start_time;
                                $now = strtotime("now ");

                                $cout_start;
                                $cut_time = $now - $t * 60 * 60;
                                $now_h = date("H", $now) + 1;

                                if ($park_id == 0) {
                                if ($t == 24) {
                                for ($i = 0; $i < 24; $i++) {
                                $business [$i] = 0;
                                }
                                for ($j = 0; $j < 24; $j++) {
                                $side[$j] = 0;
                                }
                                for ($h = 0; $h < 24; $h++) {
                                $private [$h] = 0;
                                }
                                for ($h = 0; $h < 24; $h++) {
                                $total [$h] = 0;
                                }
                                $p = 0;
                                $n = $now_h - 1;
                                // $cut_time = $now - $time * 60 * 60;
                                for ($h = 23; $h >= 0; $h--) {

                                if ($n - $p >= 0)
                                $ti[$h] = $n - $p;
                                else
                                $ti[$h] = $n - $p + 24;
                                $p++;

                                }
                                for ($j = 0; $j < 24; $j++) {
                                $time[$j] = $ti[$j] . ":00";

                                }
                                // sort($time);
                                $resut_btime = M()->query //商业车厂(1)查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=1
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>$cut_time
                                ORDER BY start_time asc ");

                                for ($i = 0; $i < count($resut_btime); $i++) {
                                $shour = date("H", $resut_btime [$i] ['start_time']);
                                if ($shour > $now_h)
                                $num = $shour - $now_h;
                                else {
                                $num = $shour - $now_h + 24;
                                }

                                $business[$num] = $business[$num] + 1;
                                $total[$num] = $total[$num] + 1;
                                }
                                $resut_stime = M()->query //路测（2）车厂查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=2
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>$cut_time
                                ORDER BY start_time asc ");
                                //echo "f".count ( $resut_stime );
                                for ($i = 0; $i < count($resut_stime); $i++) {
                                $shour = date("H", $resut_stime [$i] ['start_time']);
                                if ($shour > $now_h)
                                $num = $shour - $now_h;
                                else {
                                $num = $shour - $now_h + 24;
                                }

                                $side[$num] = $side[$num] + 1;
                                $total[$num] = $total[$num] + 1;
                                }

                                $resut_ptime = M()->query //私家车（3）车厂查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=3
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>$cut_time
                                ORDER BY start_time asc ");

                                for ($i = 0; $i < count($resut_ptime); $i++) {
                                $shour = date("H", $resut_ptime [$i] ['start_time']);
                                if ($shour > $now_h)
                                $num = $shour - $now_h;
                                else {
                                $num = $shour - $now_h + 24;
                                }

                                $private[$num] = $private[$num] + 1;
                                $total[$num] = $total[$num] + 1;

                                }
                                // echo "".$cut_time;
                                //print_r($business);

                                $array = array(
                                "time" => $time,
                                "business" => $business,
                                "side" => $side,
                                "private" => $private,
                                "total" => $total,
                                );

                                echo json_encode($array);
                                }
                                if ($start_time) {
                                //echo "fse";
                                $start_day = date("d", strtotime($start_time));
                                $start_month = date("m", strtotime($start_time));
                                $end_day = date("d", strtotime($end_time));
                                $end_month = date("m", strtotime($end_time));
                                $s = strtotime($start_time);
                                $e = strtotime($end_time);
                                $i = 0;
                                $num = 0;
                                while ($s <= $e) {

                                $time[$i] = date("d", $s);
                                $s = $s + 86400;
                                // echo "i".$time[$i]."<br>";
                                $i++;
                                $num++;
                                //echo "nuddd".$num."<br>";

                                }

                                //echo "nuddd".$num;

                                for ($i = 0; $i < $num; $i++) {
                                $business [$i] = 0;
                                }
                                for ($j = 0; $j < $num; $j++) {
                                $side[$j] = 0;
                                }
                                for ($h = 0; $h < $num; $h++) {
                                $private [$h] = 0;
                                }
                                for ($h = 0; $h < $num; $h++) {
                                $total [$h] = 0;
                                }
                                //echo"fse".$end_time;
                                $as = strtotime($start_time);
                                $ae = strtotime($end_time) + 86400;
                                $resut_btime = M()->query //商业车厂(1)查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=1
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>=$as
                                AND px_parkrecord.start_time<=$ae
                                ORDER BY start_time asc ");
                                for ($j = 0; $j < count($resut_btime); $j++) {
                                $d = date('Y-m-d', $resut_btime [$j] ['start_time']);

                                $dd = strtotime(date('Y-m-d', $as));
                                $ns = (int)((strtotime($d) - $dd) / 86400);
                                $business[$ns] = $business[$ns] + 1;
                                $total[$ns] = $total[$ns] + 1;
                                }

                                $resut_stime = M()->query //路测车厂(2)查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=2
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>=$as
                                AND px_parkrecord.start_time<=$ae
                                ORDER BY start_time asc ");
                                //echo "uoo".count( $resut_stime );
                                for ($j = 0; $j < count($resut_stime); $j++) {
                                $d = date('Y-m-d', $resut_stime [$j] ['start_time']);

                                $ns = (int)((strtotime($d) - $dd) / 86400);
                                $side[$ns] = $side[$ns] + 1;
                                $total[$ns] = $total[$ns] + 1;
                                }

                                $resut_ptime = M()->query //私人车厂(3)查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=3
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>=$as
                                AND px_parkrecord.start_time<=$ae
                                ORDER BY start_time asc ");

                                /* echo "as".$as;
                                echo "ae".$ae;
                                echo "uu".count( $resut_ptime ); */
                                for ($j = 0; $j < count($resut_ptime); $j++) {
                                $d = date('Y-m-d', $resut_ptime [$j] ['start_time']);
                                $dd = strtotime(date('Y-m-d', $as));
                                $ns = (int)((strtotime($d) - $dd) / 86400);
                                $private[$ns] = $private[$ns] + 1;
                                $total[$ns] = $total[$ns] + 1;
                                // echo "dd".$private[$ns];
                                }

                                $array = array(
                                "time" => $time,
                                "business" => $business,
                                "side" => $side,
                                "private" => $private,
                                "total" => $total,
                                );

                                echo json_encode($array);

                                }
                                } else {
                                if ($t == 24) {
                                for ($i = 0; $i < 24; $i++) {
                                $business [$i] = 0;
                                }
                                for ($j = 0; $j < 24; $j++) {
                                $side[$j] = 0;
                                }
                                for ($h = 0; $h < 24; $h++) {
                                $private [$h] = 0;
                                }
                                for ($h = 0; $h < 24; $h++) {
                                $total [$h] = 0;
                                }
                                $p = 0;
                                $n = $now_h - 1;
                                // $cut_time = $now - $time * 60 * 60;
                                for ($h = 23; $h >= 0; $h--) {

                                if ($n - $p >= 0)
                                $ti[$h] = $n - $p;
                                else
                                $ti[$h] = $n - $p + 24;
                                $p++;

                                }
                                for ($j = 0; $j < 24; $j++) {
                                $time[$j] = $ti[$j];

                                }
                                // sort($time);
                                $resut_btime = M()->query //商业车厂(1)查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=1
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>$cut_time
                                AND px_parkrecord.park_id=$park_id
                                ORDER BY start_time asc ");

                                for ($i = 0; $i < count($resut_btime); $i++) {
                                $shour = date("H", $resut_btime [$i] ['start_time']);
                                if ($shour > $now_h)
                                $num = $shour - $now_h;
                                else {
                                $num = $shour - $now_h + 24;
                                }

                                $business[$num] = $business[$num] + 1;
                                $total[$num] = $total[$num] + 1;
                                // echo "shour" . $shour . "<br>";
                                // echo "num" . $num . "<br>";
                                // echo "svalue" . $in [abs ( $now_h - $shour )] . "<br>";
                                }


                                $resut_stime = M()->query //路测（2）车厂查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=2
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>$cut_time
                                AND px_parkrecord.park_id=$park_id
                                ORDER BY start_time asc ");

                                for ($i = 0; $i < count($resut_stime); $i++) {
                                $shour = date("H", $resut_stime [$i] ['start_time']);
                                if ($shour > $now_h)
                                $num = $shour - $now_h;
                                else {
                                $num = $shour - $now_h + 24;
                                }

                                $side[$num] = $side[$num] + 1;
                                $total[$num] = $total[$num] + 1;
                                // echo "shour" . $shour . "<br>";
                                // echo "num" . $num . "<br>";
                                // echo "svalue" . $in [abs ( $now_h - $shour )] . "<br>";
                                }

                                $resut_ptime = M()->query //私家车（3）车厂查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=3
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>$cut_time
                                AND px_parkrecord.park_id=$park_id
                                ORDER BY start_time asc ");

                                for ($i = 0; $i < count($resut_ptime); $i++) {
                                $shour = date("H", $resut_ptime [$i] ['start_time']);
                                if ($shour > $now_h)
                                $num = $shour - $now_h;
                                else {
                                $num = $shour - $now_h + 24;
                                }

                                $private[$num] = $private[$num] + 1;
                                $total[$num] = $total[$num] + 1;

                                }
                                //echo "".$cut_time;
                                //print_r($business);

                                $array = array(
                                "time" => $time,
                                "business" => $business,
                                "side" => $side,
                                "private" => $private,
                                "total" => $total,
                                );
                                /* $d=strtotime('2015-7-2');
                                $as=strtotime('2015-7-1');
                                echo "ffffffffff".$d;
                                $ns=(int)(($d-$as)/86400);
                                echo "d".$ns;*/
                                echo json_encode($array);
                                }
                                if ($start_time) {
                                $start_day = date("d", strtotime($start_time));
                                $start_month = date("m", strtotime($start_time));
                                $end_day = date("d", strtotime($end_time));
                                $end_month = date("m", strtotime($end_time));
                                $s = strtotime($start_time);
                                $e = strtotime($end_time);
                                $i = 0;
                                $num = 0;
                                while ($s <= $e) {

                                $time[$i] = date("d", $s);
                                $s = $s + 86400;
                                //echo "i".$time[$i]."<br>";
                                $i++;
                                $num++;
                                //echo "nuddd".$num."<br>";

                                }

                                //echo "nuddd".$num;

                                for ($i = 0; $i < $num; $i++) {
                                $business [$i] = 0;
                                }
                                for ($j = 0; $j < $num; $j++) {
                                $side[$j] = 0;
                                }
                                for ($h = 0; $h < $num; $h++) {
                                $private [$h] = 0;
                                }
                                for ($h = 0; $h < $num; $h++) {
                                $total [$h] = 0;
                                }
                                //echo"fse".$end_time;
                                $as = strtotime($start_time);
                                $ae = strtotime($end_time) + 86400;
                                $resut_btime = M()->query //商业车厂(1)查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=1
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>=$as
                                AND px_parkrecord.start_time<=$ae
                                AND px_parkrecord.park_id=$park_id
                                ORDER BY start_time asc ");
                                for ($j = 0; $j < count($resut_btime); $j++) {
                                $d = date('Y-m-d', $resut_btime [$j] ['start_time']);

                                $dd = strtotime(date('Y-m-d', $as));
                                $ns = (int)((strtotime($d) - $dd) / 86400);
                                $business[$ns] = $business[$ns] + 1;
                                $total[$ns] = $total[$ns] + 1;
                                }

                                $resut_stime = M()->query //路测车厂(2)查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=2
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>=$as
                                AND px_parkrecord.start_time<=$ae
                                AND px_parkrecord.park_id=$park_id
                                ORDER BY start_time asc ");
                                //echo "uoo".count( $resut_stime );
                                for ($j = 0; $j < count($resut_stime); $j++) {
                                $d = date('Y-m-d', $resut_stime [$j] ['start_time']);

                                $dd = strtotime(date('Y-m-d', $as));
                                $ns = (int)((strtotime($d) - $dd) / 86400);
                                $side[$ns] = $side[$ns] + 1;
                                $total[$ns] = $total[$ns] + 1;
                                }

                                $resut_ptime = M()->query //路测车厂(2)查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=3
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>=$as
                                AND px_parkrecord.start_time<=$ae
                                AND px_parkrecord.park_id=$park_id
                                ORDER BY start_time asc ");
                                /* echo "as".$as;
                                echo "ae".$ae;
                                echo "uu".count( $resut_ptime ); */
                                for ($j = 0; $j < count($resut_ptime); $j++) {
                                $d = date('Y-m-d', $resut_ptime [$j] ['start_time']);
                                $dd = strtotime(date('Y-m-d', $as));
                                $ns = (int)((strtotime($d) - $dd) / 86400);
                                $private[$ns] = $private[$ns] + 1;
                                $total[$ns] = $total[$ns] + 1;
                                // echo "dd".$private[$ns];
                                }

                                $array = array(
                                "time" => $time,
                                "business" => $business,
                                "side" => $side,
                                "private" => $private,
                                "total" => $total,
                                );

                                echo json_encode($array);

                                }
                                }


                                }
                            </li>
                            <li>
                                $park_id = 0;//所有停车厂

                                $t = I('post.time');

                                $start_time = I('post.start_time');
                                $end_time = I('post.end_time');

                                //echo $start_time;
                                $now = strtotime("now ");

                                $cout_start;
                                $cut_time = $now - $t * 60 * 60;
                                $now_h = date("H", $now) + 1;

                                if ($park_id == 0) {
                                if ($t == 24) {
                                for ($i = 0; $i < 24; $i++) {
                                $business [$i] = 0;
                                }
                                for ($j = 0; $j < 24; $j++) {
                                $side[$j] = 0;
                                }
                                for ($h = 0; $h < 24; $h++) {
                                $private [$h] = 0;
                                }
                                for ($h = 0; $h < 24; $h++) {
                                $total [$h] = 0;
                                }
                                $p = 0;
                                $n = $now_h - 1;
                                // $cut_time = $now - $time * 60 * 60;
                                for ($h = 23; $h >= 0; $h--) {

                                if ($n - $p >= 0)
                                $ti[$h] = $n - $p;
                                else
                                $ti[$h] = $n - $p + 24;
                                $p++;

                                }
                                for ($j = 0; $j < 24; $j++) {
                                $time[$j] = $ti[$j] . ":00";

                                }
                                // sort($time);
                                $resut_btime = M()->query //商业车厂(1)查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=1
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>$cut_time
                                ORDER BY start_time asc ");

                                for ($i = 0; $i < count($resut_btime); $i++) {
                                $shour = date("H", $resut_btime [$i] ['start_time']);
                                if ($shour > $now_h)
                                $num = $shour - $now_h;
                                else {
                                $num = $shour - $now_h + 24;
                                }

                                $business[$num] = $business[$num] + 1;
                                $total[$num] = $total[$num] + 1;
                                }
                                $resut_stime = M()->query //路测（2）车厂查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=2
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>$cut_time
                                ORDER BY start_time asc ");
                                //echo "f".count ( $resut_stime );
                                for ($i = 0; $i < count($resut_stime); $i++) {
                                $shour = date("H", $resut_stime [$i] ['start_time']);
                                if ($shour > $now_h)
                                $num = $shour - $now_h;
                                else {
                                $num = $shour - $now_h + 24;
                                }

                                $side[$num] = $side[$num] + 1;
                                $total[$num] = $total[$num] + 1;
                                }

                                $resut_ptime = M()->query //私家车（3）车厂查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=3
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>$cut_time
                                ORDER BY start_time asc ");

                                for ($i = 0; $i < count($resut_ptime); $i++) {
                                $shour = date("H", $resut_ptime [$i] ['start_time']);
                                if ($shour > $now_h)
                                $num = $shour - $now_h;
                                else {
                                $num = $shour - $now_h + 24;
                                }

                                $private[$num] = $private[$num] + 1;
                                $total[$num] = $total[$num] + 1;

                                }
                                // echo "".$cut_time;
                                //print_r($business);

                                $array = array(
                                "time" => $time,
                                "business" => $business,
                                "side" => $side,
                                "private" => $private,
                                "total" => $total,
                                );

                                echo json_encode($array);
                                }
                                if ($start_time) {
                                //echo "fse";
                                $start_day = date("d", strtotime($start_time));
                                $start_month = date("m", strtotime($start_time));
                                $end_day = date("d", strtotime($end_time));
                                $end_month = date("m", strtotime($end_time));
                                $s = strtotime($start_time);
                                $e = strtotime($end_time);
                                $i = 0;
                                $num = 0;
                                while ($s <= $e) {

                                $time[$i] = date("d", $s);
                                $s = $s + 86400;
                                // echo "i".$time[$i]."<br>";
                                $i++;
                                $num++;
                                //echo "nuddd".$num."<br>";

                                }

                                //echo "nuddd".$num;

                                for ($i = 0; $i < $num; $i++) {
                                $business [$i] = 0;
                                }
                                for ($j = 0; $j < $num; $j++) {
                                $side[$j] = 0;
                                }
                                for ($h = 0; $h < $num; $h++) {
                                $private [$h] = 0;
                                }
                                for ($h = 0; $h < $num; $h++) {
                                $total [$h] = 0;
                                }
                                //echo"fse".$end_time;
                                $as = strtotime($start_time);
                                $ae = strtotime($end_time) + 86400;
                                $resut_btime = M()->query //商业车厂(1)查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=1
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>=$as
                                AND px_parkrecord.start_time<=$ae
                                ORDER BY start_time asc ");
                                for ($j = 0; $j < count($resut_btime); $j++) {
                                $d = date('Y-m-d', $resut_btime [$j] ['start_time']);

                                $dd = strtotime(date('Y-m-d', $as));
                                $ns = (int)((strtotime($d) - $dd) / 86400);
                                $business[$ns] = $business[$ns] + 1;
                                $total[$ns] = $total[$ns] + 1;
                                }

                                $resut_stime = M()->query //路测车厂(2)查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=2
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>=$as
                                AND px_parkrecord.start_time<=$ae
                                ORDER BY start_time asc ");
                                //echo "uoo".count( $resut_stime );
                                for ($j = 0; $j < count($resut_stime); $j++) {
                                $d = date('Y-m-d', $resut_stime [$j] ['start_time']);

                                $ns = (int)((strtotime($d) - $dd) / 86400);
                                $side[$ns] = $side[$ns] + 1;
                                $total[$ns] = $total[$ns] + 1;
                                }

                                $resut_ptime = M()->query //私人车厂(3)查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=3
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>=$as
                                AND px_parkrecord.start_time<=$ae
                                ORDER BY start_time asc ");

                                /* echo "as".$as;
                                echo "ae".$ae;
                                echo "uu".count( $resut_ptime ); */
                                for ($j = 0; $j < count($resut_ptime); $j++) {
                                $d = date('Y-m-d', $resut_ptime [$j] ['start_time']);
                                $dd = strtotime(date('Y-m-d', $as));
                                $ns = (int)((strtotime($d) - $dd) / 86400);
                                $private[$ns] = $private[$ns] + 1;
                                $total[$ns] = $total[$ns] + 1;
                                // echo "dd".$private[$ns];
                                }

                                $array = array(
                                "time" => $time,
                                "business" => $business,
                                "side" => $side,
                                "private" => $private,
                                "total" => $total,
                                );

                                echo json_encode($array);

                                }
                                } else {
                                if ($t == 24) {
                                for ($i = 0; $i < 24; $i++) {
                                $business [$i] = 0;
                                }
                                for ($j = 0; $j < 24; $j++) {
                                $side[$j] = 0;
                                }
                                for ($h = 0; $h < 24; $h++) {
                                $private [$h] = 0;
                                }
                                for ($h = 0; $h < 24; $h++) {
                                $total [$h] = 0;
                                }
                                $p = 0;
                                $n = $now_h - 1;
                                // $cut_time = $now - $time * 60 * 60;
                                for ($h = 23; $h >= 0; $h--) {

                                if ($n - $p >= 0)
                                $ti[$h] = $n - $p;
                                else
                                $ti[$h] = $n - $p + 24;
                                $p++;

                                }
                                for ($j = 0; $j < 24; $j++) {
                                $time[$j] = $ti[$j];

                                }
                                // sort($time);
                                $resut_btime = M()->query //商业车厂(1)查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=1
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>$cut_time
                                AND px_parkrecord.park_id=$park_id
                                ORDER BY start_time asc ");

                                for ($i = 0; $i < count($resut_btime); $i++) {
                                $shour = date("H", $resut_btime [$i] ['start_time']);
                                if ($shour > $now_h)
                                $num = $shour - $now_h;
                                else {
                                $num = $shour - $now_h + 24;
                                }

                                $business[$num] = $business[$num] + 1;
                                $total[$num] = $total[$num] + 1;
                                // echo "shour" . $shour . "<br>";
                                // echo "num" . $num . "<br>";
                                // echo "svalue" . $in [abs ( $now_h - $shour )] . "<br>";
                                }


                                $resut_stime = M()->query //路测（2）车厂查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=2
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>$cut_time
                                AND px_parkrecord.park_id=$park_id
                                ORDER BY start_time asc ");

                                for ($i = 0; $i < count($resut_stime); $i++) {
                                $shour = date("H", $resut_stime [$i] ['start_time']);
                                if ($shour > $now_h)
                                $num = $shour - $now_h;
                                else {
                                $num = $shour - $now_h + 24;
                                }

                                $side[$num] = $side[$num] + 1;
                                $total[$num] = $total[$num] + 1;
                                // echo "shour" . $shour . "<br>";
                                // echo "num" . $num . "<br>";
                                // echo "svalue" . $in [abs ( $now_h - $shour )] . "<br>";
                                }

                                $resut_ptime = M()->query //私家车（3）车厂查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=3
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>$cut_time
                                AND px_parkrecord.park_id=$park_id
                                ORDER BY start_time asc ");

                                for ($i = 0; $i < count($resut_ptime); $i++) {
                                $shour = date("H", $resut_ptime [$i] ['start_time']);
                                if ($shour > $now_h)
                                $num = $shour - $now_h;
                                else {
                                $num = $shour - $now_h + 24;
                                }

                                $private[$num] = $private[$num] + 1;
                                $total[$num] = $total[$num] + 1;

                                }
                                //echo "".$cut_time;
                                //print_r($business);

                                $array = array(
                                "time" => $time,
                                "business" => $business,
                                "side" => $side,
                                "private" => $private,
                                "total" => $total,
                                );
                                /* $d=strtotime('2015-7-2');
                                $as=strtotime('2015-7-1');
                                echo "ffffffffff".$d;
                                $ns=(int)(($d-$as)/86400);
                                echo "d".$ns;*/
                                echo json_encode($array);
                                }
                                if ($start_time) {
                                $start_day = date("d", strtotime($start_time));
                                $start_month = date("m", strtotime($start_time));
                                $end_day = date("d", strtotime($end_time));
                                $end_month = date("m", strtotime($end_time));
                                $s = strtotime($start_time);
                                $e = strtotime($end_time);
                                $i = 0;
                                $num = 0;
                                while ($s <= $e) {

                                $time[$i] = date("d", $s);
                                $s = $s + 86400;
                                //echo "i".$time[$i]."<br>";
                                $i++;
                                $num++;
                                //echo "nuddd".$num."<br>";

                                }

                                //echo "nuddd".$num;

                                for ($i = 0; $i < $num; $i++) {
                                $business [$i] = 0;
                                }
                                for ($j = 0; $j < $num; $j++) {
                                $side[$j] = 0;
                                }
                                for ($h = 0; $h < $num; $h++) {
                                $private [$h] = 0;
                                }
                                for ($h = 0; $h < $num; $h++) {
                                $total [$h] = 0;
                                }
                                //echo"fse".$end_time;
                                $as = strtotime($start_time);
                                $ae = strtotime($end_time) + 86400;
                                $resut_btime = M()->query //商业车厂(1)查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=1
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>=$as
                                AND px_parkrecord.start_time<=$ae
                                AND px_parkrecord.park_id=$park_id
                                ORDER BY start_time asc ");
                                for ($j = 0; $j < count($resut_btime); $j++) {
                                $d = date('Y-m-d', $resut_btime [$j] ['start_time']);

                                $dd = strtotime(date('Y-m-d', $as));
                                $ns = (int)((strtotime($d) - $dd) / 86400);
                                $business[$ns] = $business[$ns] + 1;
                                $total[$ns] = $total[$ns] + 1;
                                }

                                $resut_stime = M()->query //路测车厂(2)查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=2
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>=$as
                                AND px_parkrecord.start_time<=$ae
                                AND px_parkrecord.park_id=$park_id
                                ORDER BY start_time asc ");
                                //echo "uoo".count( $resut_stime );
                                for ($j = 0; $j < count($resut_stime); $j++) {
                                $d = date('Y-m-d', $resut_stime [$j] ['start_time']);

                                $dd = strtotime(date('Y-m-d', $as));
                                $ns = (int)((strtotime($d) - $dd) / 86400);
                                $side[$ns] = $side[$ns] + 1;
                                $total[$ns] = $total[$ns] + 1;
                                }

                                $resut_ptime = M()->query //路测车厂(2)查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=3
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>=$as
                                AND px_parkrecord.start_time<=$ae
                                AND px_parkrecord.park_id=$park_id
                                ORDER BY start_time asc ");
                                /* echo "as".$as;
                                echo "ae".$ae;
                                echo "uu".count( $resut_ptime ); */
                                for ($j = 0; $j < count($resut_ptime); $j++) {
                                $d = date('Y-m-d', $resut_ptime [$j] ['start_time']);
                                $dd = strtotime(date('Y-m-d', $as));
                                $ns = (int)((strtotime($d) - $dd) / 86400);
                                $private[$ns] = $private[$ns] + 1;
                                $total[$ns] = $total[$ns] + 1;
                                // echo "dd".$private[$ns];
                                }

                                $array = array(
                                "time" => $time,
                                "business" => $business,
                                "side" => $side,
                                "private" => $private,
                                "total" => $total,
                                );

                                echo json_encode($array);

                                }
                                }


                                }
                            </li>
                            <li>
                                $park_id = 0;//所有停车厂

                                $t = I('post.time');

                                $start_time = I('post.start_time');
                                $end_time = I('post.end_time');

                                //echo $start_time;
                                $now = strtotime("now ");

                                $cout_start;
                                $cut_time = $now - $t * 60 * 60;
                                $now_h = date("H", $now) + 1;

                                if ($park_id == 0) {
                                if ($t == 24) {
                                for ($i = 0; $i < 24; $i++) {
                                $business [$i] = 0;
                                }
                                for ($j = 0; $j < 24; $j++) {
                                $side[$j] = 0;
                                }
                                for ($h = 0; $h < 24; $h++) {
                                $private [$h] = 0;
                                }
                                for ($h = 0; $h < 24; $h++) {
                                $total [$h] = 0;
                                }
                                $p = 0;
                                $n = $now_h - 1;
                                // $cut_time = $now - $time * 60 * 60;
                                for ($h = 23; $h >= 0; $h--) {

                                if ($n - $p >= 0)
                                $ti[$h] = $n - $p;
                                else
                                $ti[$h] = $n - $p + 24;
                                $p++;

                                }
                                for ($j = 0; $j < 24; $j++) {
                                $time[$j] = $ti[$j] . ":00";

                                }
                                // sort($time);
                                $resut_btime = M()->query //商业车厂(1)查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=1
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>$cut_time
                                ORDER BY start_time asc ");

                                for ($i = 0; $i < count($resut_btime); $i++) {
                                $shour = date("H", $resut_btime [$i] ['start_time']);
                                if ($shour > $now_h)
                                $num = $shour - $now_h;
                                else {
                                $num = $shour - $now_h + 24;
                                }

                                $business[$num] = $business[$num] + 1;
                                $total[$num] = $total[$num] + 1;
                                }
                                $resut_stime = M()->query //路测（2）车厂查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=2
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>$cut_time
                                ORDER BY start_time asc ");
                                //echo "f".count ( $resut_stime );
                                for ($i = 0; $i < count($resut_stime); $i++) {
                                $shour = date("H", $resut_stime [$i] ['start_time']);
                                if ($shour > $now_h)
                                $num = $shour - $now_h;
                                else {
                                $num = $shour - $now_h + 24;
                                }

                                $side[$num] = $side[$num] + 1;
                                $total[$num] = $total[$num] + 1;
                                }

                                $resut_ptime = M()->query //私家车（3）车厂查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=3
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>$cut_time
                                ORDER BY start_time asc ");

                                for ($i = 0; $i < count($resut_ptime); $i++) {
                                $shour = date("H", $resut_ptime [$i] ['start_time']);
                                if ($shour > $now_h)
                                $num = $shour - $now_h;
                                else {
                                $num = $shour - $now_h + 24;
                                }

                                $private[$num] = $private[$num] + 1;
                                $total[$num] = $total[$num] + 1;

                                }
                                // echo "".$cut_time;
                                //print_r($business);

                                $array = array(
                                "time" => $time,
                                "business" => $business,
                                "side" => $side,
                                "private" => $private,
                                "total" => $total,
                                );

                                echo json_encode($array);
                                }
                                if ($start_time) {
                                //echo "fse";
                                $start_day = date("d", strtotime($start_time));
                                $start_month = date("m", strtotime($start_time));
                                $end_day = date("d", strtotime($end_time));
                                $end_month = date("m", strtotime($end_time));
                                $s = strtotime($start_time);
                                $e = strtotime($end_time);
                                $i = 0;
                                $num = 0;
                                while ($s <= $e) {

                                $time[$i] = date("d", $s);
                                $s = $s + 86400;
                                // echo "i".$time[$i]."<br>";
                                $i++;
                                $num++;
                                //echo "nuddd".$num."<br>";

                                }

                                //echo "nuddd".$num;

                                for ($i = 0; $i < $num; $i++) {
                                $business [$i] = 0;
                                }
                                for ($j = 0; $j < $num; $j++) {
                                $side[$j] = 0;
                                }
                                for ($h = 0; $h < $num; $h++) {
                                $private [$h] = 0;
                                }
                                for ($h = 0; $h < $num; $h++) {
                                $total [$h] = 0;
                                }
                                //echo"fse".$end_time;
                                $as = strtotime($start_time);
                                $ae = strtotime($end_time) + 86400;
                                $resut_btime = M()->query //商业车厂(1)查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=1
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>=$as
                                AND px_parkrecord.start_time<=$ae
                                ORDER BY start_time asc ");
                                for ($j = 0; $j < count($resut_btime); $j++) {
                                $d = date('Y-m-d', $resut_btime [$j] ['start_time']);

                                $dd = strtotime(date('Y-m-d', $as));
                                $ns = (int)((strtotime($d) - $dd) / 86400);
                                $business[$ns] = $business[$ns] + 1;
                                $total[$ns] = $total[$ns] + 1;
                                }

                                $resut_stime = M()->query //路测车厂(2)查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=2
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>=$as
                                AND px_parkrecord.start_time<=$ae
                                ORDER BY start_time asc ");
                                //echo "uoo".count( $resut_stime );
                                for ($j = 0; $j < count($resut_stime); $j++) {
                                $d = date('Y-m-d', $resut_stime [$j] ['start_time']);

                                $ns = (int)((strtotime($d) - $dd) / 86400);
                                $side[$ns] = $side[$ns] + 1;
                                $total[$ns] = $total[$ns] + 1;
                                }

                                $resut_ptime = M()->query //私人车厂(3)查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=3
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>=$as
                                AND px_parkrecord.start_time<=$ae
                                ORDER BY start_time asc ");

                                /* echo "as".$as;
                                echo "ae".$ae;
                                echo "uu".count( $resut_ptime ); */
                                for ($j = 0; $j < count($resut_ptime); $j++) {
                                $d = date('Y-m-d', $resut_ptime [$j] ['start_time']);
                                $dd = strtotime(date('Y-m-d', $as));
                                $ns = (int)((strtotime($d) - $dd) / 86400);
                                $private[$ns] = $private[$ns] + 1;
                                $total[$ns] = $total[$ns] + 1;
                                // echo "dd".$private[$ns];
                                }

                                $array = array(
                                "time" => $time,
                                "business" => $business,
                                "side" => $side,
                                "private" => $private,
                                "total" => $total,
                                );

                                echo json_encode($array);

                                }
                                } else {
                                if ($t == 24) {
                                for ($i = 0; $i < 24; $i++) {
                                $business [$i] = 0;
                                }
                                for ($j = 0; $j < 24; $j++) {
                                $side[$j] = 0;
                                }
                                for ($h = 0; $h < 24; $h++) {
                                $private [$h] = 0;
                                }
                                for ($h = 0; $h < 24; $h++) {
                                $total [$h] = 0;
                                }
                                $p = 0;
                                $n = $now_h - 1;
                                // $cut_time = $now - $time * 60 * 60;
                                for ($h = 23; $h >= 0; $h--) {

                                if ($n - $p >= 0)
                                $ti[$h] = $n - $p;
                                else
                                $ti[$h] = $n - $p + 24;
                                $p++;

                                }
                                for ($j = 0; $j < 24; $j++) {
                                $time[$j] = $ti[$j];

                                }
                                // sort($time);
                                $resut_btime = M()->query //商业车厂(1)查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=1
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>$cut_time
                                AND px_parkrecord.park_id=$park_id
                                ORDER BY start_time asc ");

                                for ($i = 0; $i < count($resut_btime); $i++) {
                                $shour = date("H", $resut_btime [$i] ['start_time']);
                                if ($shour > $now_h)
                                $num = $shour - $now_h;
                                else {
                                $num = $shour - $now_h + 24;
                                }

                                $business[$num] = $business[$num] + 1;
                                $total[$num] = $total[$num] + 1;
                                // echo "shour" . $shour . "<br>";
                                // echo "num" . $num . "<br>";
                                // echo "svalue" . $in [abs ( $now_h - $shour )] . "<br>";
                                }


                                $resut_stime = M()->query //路测（2）车厂查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=2
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>$cut_time
                                AND px_parkrecord.park_id=$park_id
                                ORDER BY start_time asc ");

                                for ($i = 0; $i < count($resut_stime); $i++) {
                                $shour = date("H", $resut_stime [$i] ['start_time']);
                                if ($shour > $now_h)
                                $num = $shour - $now_h;
                                else {
                                $num = $shour - $now_h + 24;
                                }

                                $side[$num] = $side[$num] + 1;
                                $total[$num] = $total[$num] + 1;
                                // echo "shour" . $shour . "<br>";
                                // echo "num" . $num . "<br>";
                                // echo "svalue" . $in [abs ( $now_h - $shour )] . "<br>";
                                }

                                $resut_ptime = M()->query //私家车（3）车厂查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=3
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>$cut_time
                                AND px_parkrecord.park_id=$park_id
                                ORDER BY start_time asc ");

                                for ($i = 0; $i < count($resut_ptime); $i++) {
                                $shour = date("H", $resut_ptime [$i] ['start_time']);
                                if ($shour > $now_h)
                                $num = $shour - $now_h;
                                else {
                                $num = $shour - $now_h + 24;
                                }

                                $private[$num] = $private[$num] + 1;
                                $total[$num] = $total[$num] + 1;

                                }
                                //echo "".$cut_time;
                                //print_r($business);

                                $array = array(
                                "time" => $time,
                                "business" => $business,
                                "side" => $side,
                                "private" => $private,
                                "total" => $total,
                                );
                                /* $d=strtotime('2015-7-2');
                                $as=strtotime('2015-7-1');
                                echo "ffffffffff".$d;
                                $ns=(int)(($d-$as)/86400);
                                echo "d".$ns;*/
                                echo json_encode($array);
                                }
                                if ($start_time) {
                                $start_day = date("d", strtotime($start_time));
                                $start_month = date("m", strtotime($start_time));
                                $end_day = date("d", strtotime($end_time));
                                $end_month = date("m", strtotime($end_time));
                                $s = strtotime($start_time);
                                $e = strtotime($end_time);
                                $i = 0;
                                $num = 0;
                                while ($s <= $e) {

                                $time[$i] = date("d", $s);
                                $s = $s + 86400;
                                //echo "i".$time[$i]."<br>";
                                $i++;
                                $num++;
                                //echo "nuddd".$num."<br>";

                                }

                                //echo "nuddd".$num;

                                for ($i = 0; $i < $num; $i++) {
                                $business [$i] = 0;
                                }
                                for ($j = 0; $j < $num; $j++) {
                                $side[$j] = 0;
                                }
                                for ($h = 0; $h < $num; $h++) {
                                $private [$h] = 0;
                                }
                                for ($h = 0; $h < $num; $h++) {
                                $total [$h] = 0;
                                }
                                //echo"fse".$end_time;
                                $as = strtotime($start_time);
                                $ae = strtotime($end_time) + 86400;
                                $resut_btime = M()->query //商业车厂(1)查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=1
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>=$as
                                AND px_parkrecord.start_time<=$ae
                                AND px_parkrecord.park_id=$park_id
                                ORDER BY start_time asc ");
                                for ($j = 0; $j < count($resut_btime); $j++) {
                                $d = date('Y-m-d', $resut_btime [$j] ['start_time']);

                                $dd = strtotime(date('Y-m-d', $as));
                                $ns = (int)((strtotime($d) - $dd) / 86400);
                                $business[$ns] = $business[$ns] + 1;
                                $total[$ns] = $total[$ns] + 1;
                                }

                                $resut_stime = M()->query //路测车厂(2)查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=2
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>=$as
                                AND px_parkrecord.start_time<=$ae
                                AND px_parkrecord.park_id=$park_id
                                ORDER BY start_time asc ");
                                //echo "uoo".count( $resut_stime );
                                for ($j = 0; $j < count($resut_stime); $j++) {
                                $d = date('Y-m-d', $resut_stime [$j] ['start_time']);

                                $dd = strtotime(date('Y-m-d', $as));
                                $ns = (int)((strtotime($d) - $dd) / 86400);
                                $side[$ns] = $side[$ns] + 1;
                                $total[$ns] = $total[$ns] + 1;
                                }

                                $resut_ptime = M()->query //路测车厂(2)查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=3
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>=$as
                                AND px_parkrecord.start_time<=$ae
                                AND px_parkrecord.park_id=$park_id
                                ORDER BY start_time asc ");
                                /* echo "as".$as;
                                echo "ae".$ae;
                                echo "uu".count( $resut_ptime ); */
                                for ($j = 0; $j < count($resut_ptime); $j++) {
                                $d = date('Y-m-d', $resut_ptime [$j] ['start_time']);
                                $dd = strtotime(date('Y-m-d', $as));
                                $ns = (int)((strtotime($d) - $dd) / 86400);
                                $private[$ns] = $private[$ns] + 1;
                                $total[$ns] = $total[$ns] + 1;
                                // echo "dd".$private[$ns];
                                }

                                $array = array(
                                "time" => $time,
                                "business" => $business,
                                "side" => $side,
                                "private" => $private,
                                "total" => $total,
                                );

                                echo json_encode($array);

                                }
                                }


                                }
                            </li>
                            <li>
                                $park_id = 0;//所有停车厂

                                $t = I('post.time');

                                $start_time = I('post.start_time');
                                $end_time = I('post.end_time');

                                //echo $start_time;
                                $now = strtotime("now ");

                                $cout_start;
                                $cut_time = $now - $t * 60 * 60;
                                $now_h = date("H", $now) + 1;

                                if ($park_id == 0) {
                                if ($t == 24) {
                                for ($i = 0; $i < 24; $i++) {
                                $business [$i] = 0;
                                }
                                for ($j = 0; $j < 24; $j++) {
                                $side[$j] = 0;
                                }
                                for ($h = 0; $h < 24; $h++) {
                                $private [$h] = 0;
                                }
                                for ($h = 0; $h < 24; $h++) {
                                $total [$h] = 0;
                                }
                                $p = 0;
                                $n = $now_h - 1;
                                // $cut_time = $now - $time * 60 * 60;
                                for ($h = 23; $h >= 0; $h--) {

                                if ($n - $p >= 0)
                                $ti[$h] = $n - $p;
                                else
                                $ti[$h] = $n - $p + 24;
                                $p++;

                                }
                                for ($j = 0; $j < 24; $j++) {
                                $time[$j] = $ti[$j] . ":00";

                                }
                                // sort($time);
                                $resut_btime = M()->query //商业车厂(1)查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=1
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>$cut_time
                                ORDER BY start_time asc ");

                                for ($i = 0; $i < count($resut_btime); $i++) {
                                $shour = date("H", $resut_btime [$i] ['start_time']);
                                if ($shour > $now_h)
                                $num = $shour - $now_h;
                                else {
                                $num = $shour - $now_h + 24;
                                }

                                $business[$num] = $business[$num] + 1;
                                $total[$num] = $total[$num] + 1;
                                }
                                $resut_stime = M()->query //路测（2）车厂查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=2
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>$cut_time
                                ORDER BY start_time asc ");
                                //echo "f".count ( $resut_stime );
                                for ($i = 0; $i < count($resut_stime); $i++) {
                                $shour = date("H", $resut_stime [$i] ['start_time']);
                                if ($shour > $now_h)
                                $num = $shour - $now_h;
                                else {
                                $num = $shour - $now_h + 24;
                                }

                                $side[$num] = $side[$num] + 1;
                                $total[$num] = $total[$num] + 1;
                                }

                                $resut_ptime = M()->query //私家车（3）车厂查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=3
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>$cut_time
                                ORDER BY start_time asc ");

                                for ($i = 0; $i < count($resut_ptime); $i++) {
                                $shour = date("H", $resut_ptime [$i] ['start_time']);
                                if ($shour > $now_h)
                                $num = $shour - $now_h;
                                else {
                                $num = $shour - $now_h + 24;
                                }

                                $private[$num] = $private[$num] + 1;
                                $total[$num] = $total[$num] + 1;

                                }
                                // echo "".$cut_time;
                                //print_r($business);

                                $array = array(
                                "time" => $time,
                                "business" => $business,
                                "side" => $side,
                                "private" => $private,
                                "total" => $total,
                                );

                                echo json_encode($array);
                                }
                                if ($start_time) {
                                //echo "fse";
                                $start_day = date("d", strtotime($start_time));
                                $start_month = date("m", strtotime($start_time));
                                $end_day = date("d", strtotime($end_time));
                                $end_month = date("m", strtotime($end_time));
                                $s = strtotime($start_time);
                                $e = strtotime($end_time);
                                $i = 0;
                                $num = 0;
                                while ($s <= $e) {

                                $time[$i] = date("d", $s);
                                $s = $s + 86400;
                                // echo "i".$time[$i]."<br>";
                                $i++;
                                $num++;
                                //echo "nuddd".$num."<br>";

                                }

                                //echo "nuddd".$num;

                                for ($i = 0; $i < $num; $i++) {
                                $business [$i] = 0;
                                }
                                for ($j = 0; $j < $num; $j++) {
                                $side[$j] = 0;
                                }
                                for ($h = 0; $h < $num; $h++) {
                                $private [$h] = 0;
                                }
                                for ($h = 0; $h < $num; $h++) {
                                $total [$h] = 0;
                                }
                                //echo"fse".$end_time;
                                $as = strtotime($start_time);
                                $ae = strtotime($end_time) + 86400;
                                $resut_btime = M()->query //商业车厂(1)查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=1
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>=$as
                                AND px_parkrecord.start_time<=$ae
                                ORDER BY start_time asc ");
                                for ($j = 0; $j < count($resut_btime); $j++) {
                                $d = date('Y-m-d', $resut_btime [$j] ['start_time']);

                                $dd = strtotime(date('Y-m-d', $as));
                                $ns = (int)((strtotime($d) - $dd) / 86400);
                                $business[$ns] = $business[$ns] + 1;
                                $total[$ns] = $total[$ns] + 1;
                                }

                                $resut_stime = M()->query //路测车厂(2)查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=2
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>=$as
                                AND px_parkrecord.start_time<=$ae
                                ORDER BY start_time asc ");
                                //echo "uoo".count( $resut_stime );
                                for ($j = 0; $j < count($resut_stime); $j++) {
                                $d = date('Y-m-d', $resut_stime [$j] ['start_time']);

                                $ns = (int)((strtotime($d) - $dd) / 86400);
                                $side[$ns] = $side[$ns] + 1;
                                $total[$ns] = $total[$ns] + 1;
                                }

                                $resut_ptime = M()->query //私人车厂(3)查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=3
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>=$as
                                AND px_parkrecord.start_time<=$ae
                                ORDER BY start_time asc ");

                                /* echo "as".$as;
                                echo "ae".$ae;
                                echo "uu".count( $resut_ptime ); */
                                for ($j = 0; $j < count($resut_ptime); $j++) {
                                $d = date('Y-m-d', $resut_ptime [$j] ['start_time']);
                                $dd = strtotime(date('Y-m-d', $as));
                                $ns = (int)((strtotime($d) - $dd) / 86400);
                                $private[$ns] = $private[$ns] + 1;
                                $total[$ns] = $total[$ns] + 1;
                                // echo "dd".$private[$ns];
                                }

                                $array = array(
                                "time" => $time,
                                "business" => $business,
                                "side" => $side,
                                "private" => $private,
                                "total" => $total,
                                );

                                echo json_encode($array);

                                }
                                } else {
                                if ($t == 24) {
                                for ($i = 0; $i < 24; $i++) {
                                $business [$i] = 0;
                                }
                                for ($j = 0; $j < 24; $j++) {
                                $side[$j] = 0;
                                }
                                for ($h = 0; $h < 24; $h++) {
                                $private [$h] = 0;
                                }
                                for ($h = 0; $h < 24; $h++) {
                                $total [$h] = 0;
                                }
                                $p = 0;
                                $n = $now_h - 1;
                                // $cut_time = $now - $time * 60 * 60;
                                for ($h = 23; $h >= 0; $h--) {

                                if ($n - $p >= 0)
                                $ti[$h] = $n - $p;
                                else
                                $ti[$h] = $n - $p + 24;
                                $p++;

                                }
                                for ($j = 0; $j < 24; $j++) {
                                $time[$j] = $ti[$j];

                                }
                                // sort($time);
                                $resut_btime = M()->query //商业车厂(1)查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=1
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>$cut_time
                                AND px_parkrecord.park_id=$park_id
                                ORDER BY start_time asc ");

                                for ($i = 0; $i < count($resut_btime); $i++) {
                                $shour = date("H", $resut_btime [$i] ['start_time']);
                                if ($shour > $now_h)
                                $num = $shour - $now_h;
                                else {
                                $num = $shour - $now_h + 24;
                                }

                                $business[$num] = $business[$num] + 1;
                                $total[$num] = $total[$num] + 1;
                                // echo "shour" . $shour . "<br>";
                                // echo "num" . $num . "<br>";
                                // echo "svalue" . $in [abs ( $now_h - $shour )] . "<br>";
                                }


                                $resut_stime = M()->query //路测（2）车厂查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=2
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>$cut_time
                                AND px_parkrecord.park_id=$park_id
                                ORDER BY start_time asc ");

                                for ($i = 0; $i < count($resut_stime); $i++) {
                                $shour = date("H", $resut_stime [$i] ['start_time']);
                                if ($shour > $now_h)
                                $num = $shour - $now_h;
                                else {
                                $num = $shour - $now_h + 24;
                                }

                                $side[$num] = $side[$num] + 1;
                                $total[$num] = $total[$num] + 1;
                                // echo "shour" . $shour . "<br>";
                                // echo "num" . $num . "<br>";
                                // echo "svalue" . $in [abs ( $now_h - $shour )] . "<br>";
                                }

                                $resut_ptime = M()->query //私家车（3）车厂查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=3
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>$cut_time
                                AND px_parkrecord.park_id=$park_id
                                ORDER BY start_time asc ");

                                for ($i = 0; $i < count($resut_ptime); $i++) {
                                $shour = date("H", $resut_ptime [$i] ['start_time']);
                                if ($shour > $now_h)
                                $num = $shour - $now_h;
                                else {
                                $num = $shour - $now_h + 24;
                                }

                                $private[$num] = $private[$num] + 1;
                                $total[$num] = $total[$num] + 1;

                                }
                                //echo "".$cut_time;
                                //print_r($business);

                                $array = array(
                                "time" => $time,
                                "business" => $business,
                                "side" => $side,
                                "private" => $private,
                                "total" => $total,
                                );
                                /* $d=strtotime('2015-7-2');
                                $as=strtotime('2015-7-1');
                                echo "ffffffffff".$d;
                                $ns=(int)(($d-$as)/86400);
                                echo "d".$ns;*/
                                echo json_encode($array);
                                }
                                if ($start_time) {
                                $start_day = date("d", strtotime($start_time));
                                $start_month = date("m", strtotime($start_time));
                                $end_day = date("d", strtotime($end_time));
                                $end_month = date("m", strtotime($end_time));
                                $s = strtotime($start_time);
                                $e = strtotime($end_time);
                                $i = 0;
                                $num = 0;
                                while ($s <= $e) {

                                $time[$i] = date("d", $s);
                                $s = $s + 86400;
                                //echo "i".$time[$i]."<br>";
                                $i++;
                                $num++;
                                //echo "nuddd".$num."<br>";

                                }

                                //echo "nuddd".$num;

                                for ($i = 0; $i < $num; $i++) {
                                $business [$i] = 0;
                                }
                                for ($j = 0; $j < $num; $j++) {
                                $side[$j] = 0;
                                }
                                for ($h = 0; $h < $num; $h++) {
                                $private [$h] = 0;
                                }
                                for ($h = 0; $h < $num; $h++) {
                                $total [$h] = 0;
                                }
                                //echo"fse".$end_time;
                                $as = strtotime($start_time);
                                $ae = strtotime($end_time) + 86400;
                                $resut_btime = M()->query //商业车厂(1)查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=1
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>=$as
                                AND px_parkrecord.start_time<=$ae
                                AND px_parkrecord.park_id=$park_id
                                ORDER BY start_time asc ");
                                for ($j = 0; $j < count($resut_btime); $j++) {
                                $d = date('Y-m-d', $resut_btime [$j] ['start_time']);

                                $dd = strtotime(date('Y-m-d', $as));
                                $ns = (int)((strtotime($d) - $dd) / 86400);
                                $business[$ns] = $business[$ns] + 1;
                                $total[$ns] = $total[$ns] + 1;
                                }

                                $resut_stime = M()->query //路测车厂(2)查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=2
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>=$as
                                AND px_parkrecord.start_time<=$ae
                                AND px_parkrecord.park_id=$park_id
                                ORDER BY start_time asc ");
                                //echo "uoo".count( $resut_stime );
                                for ($j = 0; $j < count($resut_stime); $j++) {
                                $d = date('Y-m-d', $resut_stime [$j] ['start_time']);

                                $dd = strtotime(date('Y-m-d', $as));
                                $ns = (int)((strtotime($d) - $dd) / 86400);
                                $side[$ns] = $side[$ns] + 1;
                                $total[$ns] = $total[$ns] + 1;
                                }

                                $resut_ptime = M()->query //路测车厂(2)查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=3
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>=$as
                                AND px_parkrecord.start_time<=$ae
                                AND px_parkrecord.park_id=$park_id
                                ORDER BY start_time asc ");
                                /* echo "as".$as;
                                echo "ae".$ae;
                                echo "uu".count( $resut_ptime ); */
                                for ($j = 0; $j < count($resut_ptime); $j++) {
                                $d = date('Y-m-d', $resut_ptime [$j] ['start_time']);
                                $dd = strtotime(date('Y-m-d', $as));
                                $ns = (int)((strtotime($d) - $dd) / 86400);
                                $private[$ns] = $private[$ns] + 1;
                                $total[$ns] = $total[$ns] + 1;
                                // echo "dd".$private[$ns];
                                }

                                $array = array(
                                "time" => $time,
                                "business" => $business,
                                "side" => $side,
                                "private" => $private,
                                "total" => $total,
                                );

                                echo json_encode($array);

                                }
                                }


                                }
                            </li>
                            <li>
                                $park_id = 0;//所有停车厂

                                $t = I('post.time');

                                $start_time = I('post.start_time');
                                $end_time = I('post.end_time');

                                //echo $start_time;
                                $now = strtotime("now ");

                                $cout_start;
                                $cut_time = $now - $t * 60 * 60;
                                $now_h = date("H", $now) + 1;

                                if ($park_id == 0) {
                                if ($t == 24) {
                                for ($i = 0; $i < 24; $i++) {
                                $business [$i] = 0;
                                }
                                for ($j = 0; $j < 24; $j++) {
                                $side[$j] = 0;
                                }
                                for ($h = 0; $h < 24; $h++) {
                                $private [$h] = 0;
                                }
                                for ($h = 0; $h < 24; $h++) {
                                $total [$h] = 0;
                                }
                                $p = 0;
                                $n = $now_h - 1;
                                // $cut_time = $now - $time * 60 * 60;
                                for ($h = 23; $h >= 0; $h--) {

                                if ($n - $p >= 0)
                                $ti[$h] = $n - $p;
                                else
                                $ti[$h] = $n - $p + 24;
                                $p++;

                                }
                                for ($j = 0; $j < 24; $j++) {
                                $time[$j] = $ti[$j] . ":00";

                                }
                                // sort($time);
                                $resut_btime = M()->query //商业车厂(1)查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=1
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>$cut_time
                                ORDER BY start_time asc ");

                                for ($i = 0; $i < count($resut_btime); $i++) {
                                $shour = date("H", $resut_btime [$i] ['start_time']);
                                if ($shour > $now_h)
                                $num = $shour - $now_h;
                                else {
                                $num = $shour - $now_h + 24;
                                }

                                $business[$num] = $business[$num] + 1;
                                $total[$num] = $total[$num] + 1;
                                }
                                $resut_stime = M()->query //路测（2）车厂查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=2
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>$cut_time
                                ORDER BY start_time asc ");
                                //echo "f".count ( $resut_stime );
                                for ($i = 0; $i < count($resut_stime); $i++) {
                                $shour = date("H", $resut_stime [$i] ['start_time']);
                                if ($shour > $now_h)
                                $num = $shour - $now_h;
                                else {
                                $num = $shour - $now_h + 24;
                                }

                                $side[$num] = $side[$num] + 1;
                                $total[$num] = $total[$num] + 1;
                                }

                                $resut_ptime = M()->query //私家车（3）车厂查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=3
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>$cut_time
                                ORDER BY start_time asc ");

                                for ($i = 0; $i < count($resut_ptime); $i++) {
                                $shour = date("H", $resut_ptime [$i] ['start_time']);
                                if ($shour > $now_h)
                                $num = $shour - $now_h;
                                else {
                                $num = $shour - $now_h + 24;
                                }

                                $private[$num] = $private[$num] + 1;
                                $total[$num] = $total[$num] + 1;

                                }
                                // echo "".$cut_time;
                                //print_r($business);

                                $array = array(
                                "time" => $time,
                                "business" => $business,
                                "side" => $side,
                                "private" => $private,
                                "total" => $total,
                                );

                                echo json_encode($array);
                                }
                                if ($start_time) {
                                //echo "fse";
                                $start_day = date("d", strtotime($start_time));
                                $start_month = date("m", strtotime($start_time));
                                $end_day = date("d", strtotime($end_time));
                                $end_month = date("m", strtotime($end_time));
                                $s = strtotime($start_time);
                                $e = strtotime($end_time);
                                $i = 0;
                                $num = 0;
                                while ($s <= $e) {

                                $time[$i] = date("d", $s);
                                $s = $s + 86400;
                                // echo "i".$time[$i]."<br>";
                                $i++;
                                $num++;
                                //echo "nuddd".$num."<br>";

                                }

                                //echo "nuddd".$num;

                                for ($i = 0; $i < $num; $i++) {
                                $business [$i] = 0;
                                }
                                for ($j = 0; $j < $num; $j++) {
                                $side[$j] = 0;
                                }
                                for ($h = 0; $h < $num; $h++) {
                                $private [$h] = 0;
                                }
                                for ($h = 0; $h < $num; $h++) {
                                $total [$h] = 0;
                                }
                                //echo"fse".$end_time;
                                $as = strtotime($start_time);
                                $ae = strtotime($end_time) + 86400;
                                $resut_btime = M()->query //商业车厂(1)查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=1
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>=$as
                                AND px_parkrecord.start_time<=$ae
                                ORDER BY start_time asc ");
                                for ($j = 0; $j < count($resut_btime); $j++) {
                                $d = date('Y-m-d', $resut_btime [$j] ['start_time']);

                                $dd = strtotime(date('Y-m-d', $as));
                                $ns = (int)((strtotime($d) - $dd) / 86400);
                                $business[$ns] = $business[$ns] + 1;
                                $total[$ns] = $total[$ns] + 1;
                                }

                                $resut_stime = M()->query //路测车厂(2)查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=2
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>=$as
                                AND px_parkrecord.start_time<=$ae
                                ORDER BY start_time asc ");
                                //echo "uoo".count( $resut_stime );
                                for ($j = 0; $j < count($resut_stime); $j++) {
                                $d = date('Y-m-d', $resut_stime [$j] ['start_time']);

                                $ns = (int)((strtotime($d) - $dd) / 86400);
                                $side[$ns] = $side[$ns] + 1;
                                $total[$ns] = $total[$ns] + 1;
                                }

                                $resut_ptime = M()->query //私人车厂(3)查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=3
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>=$as
                                AND px_parkrecord.start_time<=$ae
                                ORDER BY start_time asc ");

                                /* echo "as".$as;
                                echo "ae".$ae;
                                echo "uu".count( $resut_ptime ); */
                                for ($j = 0; $j < count($resut_ptime); $j++) {
                                $d = date('Y-m-d', $resut_ptime [$j] ['start_time']);
                                $dd = strtotime(date('Y-m-d', $as));
                                $ns = (int)((strtotime($d) - $dd) / 86400);
                                $private[$ns] = $private[$ns] + 1;
                                $total[$ns] = $total[$ns] + 1;
                                // echo "dd".$private[$ns];
                                }

                                $array = array(
                                "time" => $time,
                                "business" => $business,
                                "side" => $side,
                                "private" => $private,
                                "total" => $total,
                                );

                                echo json_encode($array);

                                }
                                } else {
                                if ($t == 24) {
                                for ($i = 0; $i < 24; $i++) {
                                $business [$i] = 0;
                                }
                                for ($j = 0; $j < 24; $j++) {
                                $side[$j] = 0;
                                }
                                for ($h = 0; $h < 24; $h++) {
                                $private [$h] = 0;
                                }
                                for ($h = 0; $h < 24; $h++) {
                                $total [$h] = 0;
                                }
                                $p = 0;
                                $n = $now_h - 1;
                                // $cut_time = $now - $time * 60 * 60;
                                for ($h = 23; $h >= 0; $h--) {

                                if ($n - $p >= 0)
                                $ti[$h] = $n - $p;
                                else
                                $ti[$h] = $n - $p + 24;
                                $p++;

                                }
                                for ($j = 0; $j < 24; $j++) {
                                $time[$j] = $ti[$j];

                                }
                                // sort($time);
                                $resut_btime = M()->query //商业车厂(1)查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=1
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>$cut_time
                                AND px_parkrecord.park_id=$park_id
                                ORDER BY start_time asc ");

                                for ($i = 0; $i < count($resut_btime); $i++) {
                                $shour = date("H", $resut_btime [$i] ['start_time']);
                                if ($shour > $now_h)
                                $num = $shour - $now_h;
                                else {
                                $num = $shour - $now_h + 24;
                                }

                                $business[$num] = $business[$num] + 1;
                                $total[$num] = $total[$num] + 1;
                                // echo "shour" . $shour . "<br>";
                                // echo "num" . $num . "<br>";
                                // echo "svalue" . $in [abs ( $now_h - $shour )] . "<br>";
                                }


                                $resut_stime = M()->query //路测（2）车厂查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=2
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>$cut_time
                                AND px_parkrecord.park_id=$park_id
                                ORDER BY start_time asc ");

                                for ($i = 0; $i < count($resut_stime); $i++) {
                                $shour = date("H", $resut_stime [$i] ['start_time']);
                                if ($shour > $now_h)
                                $num = $shour - $now_h;
                                else {
                                $num = $shour - $now_h + 24;
                                }

                                $side[$num] = $side[$num] + 1;
                                $total[$num] = $total[$num] + 1;
                                // echo "shour" . $shour . "<br>";
                                // echo "num" . $num . "<br>";
                                // echo "svalue" . $in [abs ( $now_h - $shour )] . "<br>";
                                }

                                $resut_ptime = M()->query //私家车（3）车厂查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=3
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>$cut_time
                                AND px_parkrecord.park_id=$park_id
                                ORDER BY start_time asc ");

                                for ($i = 0; $i < count($resut_ptime); $i++) {
                                $shour = date("H", $resut_ptime [$i] ['start_time']);
                                if ($shour > $now_h)
                                $num = $shour - $now_h;
                                else {
                                $num = $shour - $now_h + 24;
                                }

                                $private[$num] = $private[$num] + 1;
                                $total[$num] = $total[$num] + 1;

                                }
                                //echo "".$cut_time;
                                //print_r($business);

                                $array = array(
                                "time" => $time,
                                "business" => $business,
                                "side" => $side,
                                "private" => $private,
                                "total" => $total,
                                );
                                /* $d=strtotime('2015-7-2');
                                $as=strtotime('2015-7-1');
                                echo "ffffffffff".$d;
                                $ns=(int)(($d-$as)/86400);
                                echo "d".$ns;*/
                                echo json_encode($array);
                                }
                                if ($start_time) {
                                $start_day = date("d", strtotime($start_time));
                                $start_month = date("m", strtotime($start_time));
                                $end_day = date("d", strtotime($end_time));
                                $end_month = date("m", strtotime($end_time));
                                $s = strtotime($start_time);
                                $e = strtotime($end_time);
                                $i = 0;
                                $num = 0;
                                while ($s <= $e) {

                                $time[$i] = date("d", $s);
                                $s = $s + 86400;
                                //echo "i".$time[$i]."<br>";
                                $i++;
                                $num++;
                                //echo "nuddd".$num."<br>";

                                }

                                //echo "nuddd".$num;

                                for ($i = 0; $i < $num; $i++) {
                                $business [$i] = 0;
                                }
                                for ($j = 0; $j < $num; $j++) {
                                $side[$j] = 0;
                                }
                                for ($h = 0; $h < $num; $h++) {
                                $private [$h] = 0;
                                }
                                for ($h = 0; $h < $num; $h++) {
                                $total [$h] = 0;
                                }
                                //echo"fse".$end_time;
                                $as = strtotime($start_time);
                                $ae = strtotime($end_time) + 86400;
                                $resut_btime = M()->query //商业车厂(1)查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=1
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>=$as
                                AND px_parkrecord.start_time<=$ae
                                AND px_parkrecord.park_id=$park_id
                                ORDER BY start_time asc ");
                                for ($j = 0; $j < count($resut_btime); $j++) {
                                $d = date('Y-m-d', $resut_btime [$j] ['start_time']);

                                $dd = strtotime(date('Y-m-d', $as));
                                $ns = (int)((strtotime($d) - $dd) / 86400);
                                $business[$ns] = $business[$ns] + 1;
                                $total[$ns] = $total[$ns] + 1;
                                }

                                $resut_stime = M()->query //路测车厂(2)查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=2
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>=$as
                                AND px_parkrecord.start_time<=$ae
                                AND px_parkrecord.park_id=$park_id
                                ORDER BY start_time asc ");
                                //echo "uoo".count( $resut_stime );
                                for ($j = 0; $j < count($resut_stime); $j++) {
                                $d = date('Y-m-d', $resut_stime [$j] ['start_time']);

                                $dd = strtotime(date('Y-m-d', $as));
                                $ns = (int)((strtotime($d) - $dd) / 86400);
                                $side[$ns] = $side[$ns] + 1;
                                $total[$ns] = $total[$ns] + 1;
                                }

                                $resut_ptime = M()->query //路测车厂(2)查询结果
                                ("SELECT px_parkrecord.start_time FROM px_parkrecord,px_park WHERE px_park.type=3
                                AND px_parkrecord.park_id=px_park.id
                                AND px_parkrecord.start_time>=$as
                                AND px_parkrecord.start_time<=$ae
                                AND px_parkrecord.park_id=$park_id
                                ORDER BY start_time asc ");
                                /* echo "as".$as;
                                echo "ae".$ae;
                                echo "uu".count( $resut_ptime ); */
                                for ($j = 0; $j < count($resut_ptime); $j++) {
                                $d = date('Y-m-d', $resut_ptime [$j] ['start_time']);
                                $dd = strtotime(date('Y-m-d', $as));
                                $ns = (int)((strtotime($d) - $dd) / 86400);
                                $private[$ns] = $private[$ns] + 1;
                                $total[$ns] = $total[$ns] + 1;
                                // echo "dd".$private[$ns];
                                }

                                $array = array(
                                "time" => $time,
                                "business" => $business,
                                "side" => $side,
                                "private" => $private,
                                "total" => $total,
                                );

                                echo json_encode($array);

                                }
                                }


                                }
                            </li>
                        </ul>
                    </div>
                </section>
                <section id="car-bottom-board"></section>
            </section>
        </div>
        <div class="right-container col-lg-3">
            <section class="right-top">
                <div class="progress">
                    <div class="progress-bar progress-bar-info progress-bar-striped" role="progressbar"
                         aria-valuenow="20" aria-valuemin="0" aria-valuemax="100" style="width: 20%">
                        <span class="sr-only">20% Complete</span>
                    </div>
                </div>
                <section id="right-top-map"></section>
            </section>
            <section class="right-bottom clearfix">
                <h3>还有<br><br><span>{{same.num}}</span>位<br><br>欲前往创业大厦</h3>
                <ul>
                    <li>
                        <p>用户名：<span>{{same.data[0].user_name}}</span></p>
                    </li>
                    <li>
                        <p>车辆：<span>{{same.data[0].type}}</span></p>
                    </li>
                    <li>
                        <p>车牌号：<span>{{same.data[0].car_no}}</span></p>
                    </li>
                    <li>
                        <p>当前位置：<span>{{same.data[0].current}}</span></p>
                    </li>
                    <li>
                        <p>目标位置：<span>{{same.data[0].destination}}</span></p>
                    </li>
                </ul>
            </section>
        </div>
    </div>
</div>
<script>
    var public = "__PUBLIC__";
</script>
<script type="text/javascript" src="__PUBLIC__/js/jquery-1.11.2.min.js"></script>
<script src="__PUBLIC__/js/index.js"></script>
<script src="__PUBLIC__/js/myCharts.js"></script>
<script src="__PUBLIC__/js/echarts/build/dist/echarts-all.js"></script>
<script src="__PUBLIC__/js/echarts/build/dist/echarts.js"></script>
<script src="__PUBLIC__/js/echarts-x/build/dist/echarts-x.js"></script>
<script type="text/javascript" src="__PUBLIC__/js/3dCarRoate.min.js"></script>
<script src="__PUBLIC__/js/animation/pagetransitions.js"></script>
<!-- 百度地图API -->
<script type="text/javascript" src="http://api.map.baidu.com/api?v=2.0&ak=PwRzDnXRpLX9il1fGjQNpDiX"></script>

<script type="text/javascript">

</script>
<script type="text/javascript">
    $(document).ready(function () {
        $("#myCar").rote3D({
            imagePath: "__PUBLIC__/images/img/",
            totalImages: 51,
            imageExtension: "png",
        });
    });
    // 百度地图API功能
    var map = new BMap.Map("right-top-map"); // 创建Map实例
    map.centerAndZoom(new BMap.Point(116.404, 39.915), 11); // 初始化地图,设置中心点坐标和地图级别
    map.addControl(new BMap.MapTypeControl()); //添加地图类型控件
    map.setCurrentCity("北京"); // 设置地图显示的城市 此项是必须设置的
    map.enableScrollWheelZoom(true); //开启鼠标滚轮缩放
</script>
<script>
    var carApp = angular.module('carApp', []);

    carApp.factory('Demand_Data', function ($http, $q) {
        return {
            query: function () {
                var config = {
                    params: {
                        'time': 0,
                        'time_type': 1,
                        'type': 2
                    }
                };
                var defered = $q.defer();
                $http.get("{:U('Demand/get_list')}", config).then(
                        function successCallback(response) {
                            var demand_datas = response.data;
                            var l = Math.floor(demand_datas.length * Math.random());
                            defered.resolve(demand_datas[l]);
                        },
                        function errCallback(response) {
                            defered.reject(response);
                        }
                );
                return defered.promise;
            }
        }
    });

    carApp.factory('Preference_Data', function ($http, $q) {
        return {
            query: function (user_id) {
                var config = {
                    params: {
                        'user_id': user_id
                    }
                };
                var defered = $q.defer();
                $http.get("{:U('Demand/preference')}", config).then(
                        function successCallback(response) {
                            defered.resolve(response.data);
                        },
                        function errCallback(response) {
                            defered.reject(response);
                        }
                );
                return defered.promise;
            }
        }
    });

    carApp.factory('SameBusiness_Data', function ($http, $q) {
        return {
            query: function (business) {
                var config = {
                    params: {
                        'business': business
                    }
                };
                var defered = $q.defer();
                $http.get("{:U('Demand/count_demand')}", config).then(
                        function successCallback(response) {
                            defered.resolve(response.data);
                        },
                        function errCallback(response) {
                            defered.reject(response);
                        }
                );
                return defered.promise;
            }
        }
    });

    carApp.factory('Count_Data', function ($http, $q) {
        return {
            query: function (business) {
                var defered = $q.defer();
                $http.get("{:U('Demand/count')}").then(
                        function successCallback(response) {
                            defered.resolve(response.data);
                        },
                        function errCallback(response) {
                            defered.reject(response);
                        }
                );
                return defered.promise;
            }
        }
    });

    carApp.factory('Parkrecord_Data', function ($http, $q) {
        return {
            query: function (user_id) {
                var config = {
                    params: {
                        'user_id': user_id
                    }
                };
                var defered = $q.defer();
                $http.get("{:U('Parkrecord/get_record')}", config).then(
                        function successCallback(response) {
                            defered.resolve(response.data);
                        },
                        function errCallback(response) {
                            defered.reject(response);
                        }
                );
                return defered.promise;
            }
        }
    });

    carApp.controller('DemandCtrl', function ($scope, Demand_Data, Preference_Data, SameBusiness_Data, Count_Data,Parkrecord_Data) {

        var promise = Demand_Data.query();
        promise.then(function (data) {  // 调用承诺API获取数据 .resolve
            console.log(data);
            user(data);
            position(data);

            //获取雷达图数据
            var promise1 = Preference_Data.query(data.user_id);
            promise1.then(function (data1) {
                createRadar(data1);
            }, function (data1) {
                createRadar([20, 20, 20, 20, 20]);
            });

            //获取前往同一商圈的数据
            var promise2 = SameBusiness_Data.query(data.business);
            promise2.then(function (data2) {
                same(data2);
            }, function (data2) {
                alert(data2);
            });

            //获取当前有多少人计算
            var promise3 = Count_Data.query(data.business);
            promise3.then(function (data3) {
                createGauge(data3);
            }, function (data3) {
                alert(data3);
            });

            //获取个人停车记录
            var promise4 = Count_Data.query(data.user_id);
            promise4.then(function (data4) {
                park_record(data4);
            }, function (data4) {
                alert(data4);
            });
        }, function (data) {  // 处理错误 .reject
            alert('haha');
        });

        require.config({
            paths: {
                'echarts': "__PUBLIC__/js/echarts/build/dist",
                'echarts-x': "__PUBLIC__/js/echarts-x/build/dist"
            }
        });
        require([
            'echarts',
            'echarts-x',
            // ECharts-X 中 map3d 的地图绘制基于 ECharts 中的 map。
            'echarts/chart/map',
            'echarts-x/chart/map3d',
        ], function (ec) {
            var t = 0;
            /*首先加载地球旋转*/
            createEarth(ec);
            /*当地球旋转加载完成，开始加载第二页的图表*/
            var timer = setInterval(function () {
                t += 1;
                if (isReady) {
                    $('body').css({
                        'background': 'url(__PUBLIC__/images/backWhole.png)',
                        'background-size': '100% !important'
                    });
                }
                if (isReady || t > 50) {
                    var data = [20, 20, 20, 20, 20];
                    createRadar(data);
                    createGauge(ec);
                    createPie(ec);
                    clearInterval(timer);
                }
            }, 100);
        });


        function position(d) {
            var p = {};
            p.start = d.current_business;
            p.end = d.business;
            $scope.posi = p;
        };

        function user(d) {
            var u = {};
            u.name = d.User.nickname;
            if (d.User.img) {
                u.img = "__ROOT__/Uploads/UserIcon/" + d.User.img;
            } else {
                u.img = "__ROOT__/Uploads/UserIcon/default.jpg";
            }
            $scope.u = u;
        }

        function preference(d) {
            var config = {
                params: {
                    'user_id': d.User.id
                }
            };
            $http.get("{:U('Demand/preference')}", config).then(
                    function successCallback(response) {
                        var preference_data = response.data;
                        createRadar()
                        console.log(preference_data);
                    },
                    function errCallback(response) {
                        alert('error');
                    }
            );
        }

        function same(d) {
            $scope.same = d;
        }

        function park_record(d){
            $scope.park_records=d;
        }

        function _change(newValue, oldValue, scope) {
            alert('haha');
            console.log(newValue);
        };

        //$scope.$watch($scope.demand, _change, true);
    });
</script>
</body>
</html>
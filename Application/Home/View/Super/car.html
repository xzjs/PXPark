<!doctype html>
<html lang="en" ng-app="carApp">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="renderer" content="webkit">
    <title>index</title>
    <link rel="stylesheet" href="__PUBLIC__/css/style.css">
    <link rel="stylesheet" href="__PUBLIC__/css/bootstrap.css">
    <link rel="stylesheet" href="__PUBLIC__/css/bootstrap-theme.css">
    <link rel="stylesheet" href="__PUBLIC__/css/font-awesome.min.css">
    <!--页面过渡动画-->
    <link rel="stylesheet" href="__PUBLIC__/css/animation/animations.css">
    <link rel="stylesheet" href="__PUBLIC__/css/animation/component.css">
    <script src="__PUBLIC__/js/animation/modernizr.custom.js"></script>
    <script src="//cdn.bootcss.com/angular.js/1.5.0-beta.1/angular.min.js"></script>
</head>
<body ng-controller="DemandCtrl">


<div id="pt-main" class="pt-perspective">
    <div class="pt-page pt-page-1">
        <div class="pt-triggers">
            <button id="iterateEffects" class="pt-touch-button">显示下一页切换</button>
        </div>
        <!-- /triggers -->
        <div id="echarts-x-content"></div>
        <div class="pt-message">
            <p>亲，你的浏览器不支持 CSS 动画，请使用 Chrome,Firefox,Safari 等浏览器浏览.</p>
        </div>
    </div>
    <div class="pt-page pt-page-2 row">
        <div class="left-container col-lg-3">
            <section class="left-top">
                <div class="left-top-text">
                    <p>当前位置:<span>{{posi.start}}</span></p>

                    <p>目标位置:<span>{{posi.end}}</span></p>
                </div>
                <div id="radar-chart"></div>
            </section>
            <section class="left-mid">
                <ul>
                    <li>
                        <p>2015.11.20 20:50~21:50</p>

                        <p>万达广场停车场 消费1元</p>
                    </li>
                    <li>
                        <p>2015.11.20 20:50~21:50</p>

                        <p>万达广场停车场 消费1元</p>
                    </li>
                    <li>
                        <p>2015.11.20 20:50~21:50</p>

                        <p>万达广场停车场 消费1元</p>
                    </li>
                    <li>
                        <p>2015.11.20 20:50~21:50</p>

                        <p>万达广场停车场 消费1元</p>
                    </li>
                    <li>
                        <p>2015.11.20 20:50~21:50</p>

                        <p>万达广场停车场 消费1元</p>
                    </li>
                    <li>
                        <p>2015.11.20 20:50~21:50</p>

                        <p>万达广场停车场 消费1元</p>
                    </li>
                    <li>
                        <p>2015.11.20 20:50~21:50</p>

                        <p>万达广场停车场 消费1元</p>
                    </li>
                    <li>
                        <p>2015.11.20 20:50~21:50</p>

                        <p>万达广场停车场 消费1元</p>
                    </li>
                    <li>
                        <p>2015.11.20 20:50~21:50</p>

                        <p>万达广场停车场 消费1元</p>
                    </li>
                    <li>
                        <p>2015.11.20 20:50~21:50</p>

                        <p>万达广场停车场 消费1元</p>
                    </li>
                </ul>
            </section>
            <section class="left-bottom">
                <div class="left-bottom-text">
                    <p>天气：<span>晴</span></p>

                    <p>风力：<span>3级</span></p>

                    <p>温度：<span>2-10C</span></p>

                    <p class="weather">雾</p>
                </div>
                <div class="left-bottom-scroll">
                    <ul>
                        <li>
                            在南方的小镇，住着一个北方的姑娘，她时常穿着带花的裙子 站在路旁
                            她的话不多，但笑起来是那么平静优雅，她柔弱的眼神装的是什么，是
                            思念的忧伤
                        </li>
                        <li>
                            在南方的小镇，住着一个北方的姑娘，她时常穿着带花的裙子 站在路旁
                            她的话不多，但笑起来是那么平静优雅，她柔弱的眼神装的是什么，是
                            思念的忧伤
                        </li>
                        <li>
                            在南方的小镇，住着一个北方的姑娘，她时常穿着带花的裙子 站在路旁
                            她的话不多，但笑起来是那么平静优雅，她柔弱的眼神装的是什么，是
                            思念的忧伤
                        </li>
                        <li>
                            在南方的小镇，住着一个北方的姑娘，她时常穿着带花的裙子 站在路旁
                            她的话不多，但笑起来是那么平静优雅，她柔弱的眼神装的是什么，是
                            思念的忧伤
                        </li>
                        <li>
                            在南方的小镇，住着一个北方的姑娘，她时常穿着带花的裙子 站在路旁
                            她的话不多，但笑起来是那么平静优雅，她柔弱的眼神装的是什么，是
                            思念的忧伤
                        </li>
                        <li>
                            在南方的小镇，住着一个北方的姑娘，她时常穿着带花的裙子 站在路旁
                            她的话不多，但笑起来是那么平静优雅，她柔弱的眼神装的是什么，是
                            思念的忧伤
                        </li>
                    </ul>
                </div>
            </section>
        </div>
        <div class="car-container col-lg-6">
            <section class="car-user clearfix">
                <img src="{{u.img}}" alt="车主">
                <ul>
                    <li>
                        <p>用户名：<span>{{u.name}}</span></p>
                    </li>
                    <li>
                        <p>性别：<span>男</span></p>
                    </li>
                    <li>
                        <p>年龄：<span>33</span></p>
                    </li>
                    <li>
                        <p>职业：<span>歌手</span></p>
                    </li>
                    <li>
                        <p>驾龄：<span>3年</span></p>
                    </li>
                    <li>
                        <!--i标签为小星星，i的数量即为星星的数量-->
                        <p>信用情况：<span>
                            <i class="icon-star"></i>
                            <i class="icon-star"></i>
                        </span></p>
                    </li>
                </ul>
            </section>
            <section class="car-charts clearfix">
                <div id="car-charts1"></div>
                <div id="car-charts2"></div>
            </section>
            <section class="car-content">
                <section id="myCar"></section>
                <ul class="car-list">
                    <li><p>创业大厦停车场</p></li>
                    <li><p>创业大厦停车场</p></li>
                    <li><p>创业大厦停车场</p></li>
                    <li><p>创业大厦停车场</p></li>
                    <li><p>创业大厦停车场</p></li>
                    <li><p>创业大厦停车场</p></li>
                    <li><p>创业大厦停车场</p></li>
                    <li><p>创业大厦停车场</p></li>
                </ul>
            </section>
            <section class="car-bottom clearfix">
                <section class="car-bottom-text">
                    <div class="car-content-text">
                        <ul>
                            <li>
                                在南方的小镇，住着一个北方的姑娘，她时常穿着带花的裙子 站在路旁
                                她的话不多，但笑起来是那么平静优雅，她柔弱的眼神装的是什么，是
                                思念的忧伤
                            </li>
                            <li>
                                在南方的小镇，住着一个北方的姑娘，她时常穿着带花的裙子 站在路旁
                                她的话不多，但笑起来是那么平静优雅，她柔弱的眼神装的是什么，是
                                思念的忧伤
                            </li>
                            <li>
                                在南方的小镇，住着一个北方的姑娘，她时常穿着带花的裙子 站在路旁
                                她的话不多，但笑起来是那么平静优雅，她柔弱的眼神装的是什么，是
                                思念的忧伤
                            </li>
                            <li>
                                在南方的小镇，住着一个北方的姑娘，她时常穿着带花的裙子 站在路旁
                                她的话不多，但笑起来是那么平静优雅，她柔弱的眼神装的是什么，是
                                思念的忧伤
                            </li>
                            <li>
                                在南方的小镇，住着一个北方的姑娘，她时常穿着带花的裙子 站在路旁
                                她的话不多，但笑起来是那么平静优雅，她柔弱的眼神装的是什么，是
                                思念的忧伤
                            </li>
                            <li>
                                在南方的小镇，住着一个北方的姑娘，她时常穿着带花的裙子 站在路旁
                                她的话不多，但笑起来是那么平静优雅，她柔弱的眼神装的是什么，是
                                思念的忧伤
                            </li>
                            <li>
                                在南方的小镇，住着一个北方的姑娘，她时常穿着带花的裙子 站在路旁
                                她的话不多，但笑起来是那么平静优雅，她柔弱的眼神装的是什么，是
                                思念的忧伤
                            </li>
                            <li>
                                在南方的小镇，住着一个北方的姑娘，她时常穿着带花的裙子 站在路旁
                                她的话不多，但笑起来是那么平静优雅，她柔弱的眼神装的是什么，是
                                思念的忧伤
                            </li>
                            <li>
                                在南方的小镇，住着一个北方的姑娘，她时常穿着带花的裙子 站在路旁
                                她的话不多，但笑起来是那么平静优雅，她柔弱的眼神装的是什么，是
                                思念的忧伤
                            </li>
                            <li>
                                在南方的小镇，住着一个北方的姑娘，她时常穿着带花的裙子 站在路旁
                                她的话不多，但笑起来是那么平静优雅，她柔弱的眼神装的是什么，是
                                思念的忧伤
                            </li>
                        </ul>
                    </div>
                </section>
                <section id="car-bottom-board"></section>
            </section>
        </div>
        <div class="right-container col-lg-3">
            <section class="right-top">
                <div class="progress">
                    <div class="progress-bar progress-bar-info progress-bar-striped" role="progressbar"
                         aria-valuenow="20" aria-valuemin="0" aria-valuemax="100" style="width: 20%">
                        <span class="sr-only">20% Complete</span>
                    </div>
                </div>
                <section id="right-top-map"></section>
            </section>
            <section class="right-bottom clearfix">
                <h3>还有<br><br><span>103</span>位<br><br>欲前往创业大厦</h3>
                <ul>
                    <li>
                        <p>用户名：<span>JAY</span></p>
                    </li>
                    <li>
                        <p>车辆：<span>本田</span></p>
                    </li>
                    <li>
                        <p>车牌号：<span>鲁B1234</span></p>
                    </li>
                    <li>
                        <p>当前位置：<span>市政府</span></p>
                    </li>
                    <li>
                        <p>目标位置：<span>创业大厦</span></p>
                    </li>
                </ul>
            </section>
        </div>
    </div>
</div>
<script>
    var public = "__PUBLIC__";
</script>
<script type="text/javascript" src="__PUBLIC__/js/jquery-1.11.2.min.js"></script>
<script src="__PUBLIC__/js/index.js"></script>
<script src="__PUBLIC__/js/myCharts.js"></script>
<script src="__PUBLIC__/js/echarts/build/dist/echarts.js"></script>
<script src="__PUBLIC__/js/echarts-x/build/dist/echarts-x.js"></script>
<script type="text/javascript" src="__PUBLIC__/js/3dCarRoate.min.js"></script>
<script src="__PUBLIC__/js/animation/pagetransitions.js"></script>
<!-- 百度地图API -->
<script type="text/javascript" src="http://api.map.baidu.com/api?v=2.0&ak=PwRzDnXRpLX9il1fGjQNpDiX"></script>

<script type="text/javascript">
    require.config({
        paths: {
            'echarts': "__PUBLIC__/js/echarts/build/dist",
            'echarts-x': "__PUBLIC__/js/echarts-x/build/dist"
        }
    });
    require([
        'echarts',
        'echarts-x',
        // ECharts-X 中 map3d 的地图绘制基于 ECharts 中的 map。
        'echarts/chart/map',
        'echarts-x/chart/map3d',
        'echarts/chart/radar',
        'echarts/chart/gauge',
        'echarts/chart/pie',
        'echarts/chart/funnel'
    ], function (ec) {
        var t = 0;
        /*首先加载地球旋转*/
        createEarth(ec);
        /*当地球旋转加载完成，开始加载第二页的图表*/
        var timer = setInterval(function () {
            t += 1;
            if (isReady) {
                $('body').css({
                    'background': 'url(__PUBLIC__/images/backWhole.png)',
                    'background-size': '100% !important'
                });
            }
            if (isReady || t > 50) {
                data=[0,0,0,0,0];
                createRadar(ec,data);
                createGauge(ec);
                createPie(ec);
                clearInterval(timer);
            }
        }, 100)
    })
</script>
<script type="text/javascript">
    $(document).ready(function () {
        $("#myCar").rote3D({
            imagePath: "__PUBLIC__/images/img/",
            totalImages: 51,
            imageExtension: "png",
        });
    });
    // 百度地图API功能
    var map = new BMap.Map("right-top-map"); // 创建Map实例
    map.centerAndZoom(new BMap.Point(116.404, 39.915), 11); // 初始化地图,设置中心点坐标和地图级别
    map.addControl(new BMap.MapTypeControl()); //添加地图类型控件
    map.setCurrentCity("北京"); // 设置地图显示的城市 此项是必须设置的
    map.enableScrollWheelZoom(true); //开启鼠标滚轮缩放
</script>
<script>
    var carApp = angular.module('carApp', []);

    carApp.factory('Data', function () {
        return {
            demand: {}
        }
    });

    carApp.controller('DemandCtrl', function ($scope, $http) {
        var config = {
            params: {
                'time': 0,
                'time_type': 1,
                'type': 2
            }
        };
        $http.get("{:U('Demand/get_list')}", config).then(
                function successCallback(response) {
                    var demand_datas = response.data;
                    var l = Math.floor(demand_datas.length * Math.random());
                    var demand = demand_datas[l];
                    console.log(demand);
                    position(demand);
                    user(demand);
                    preference(demand);
                },
                function errCallback(response) {
                    alert('error');
                }
        );
        function position(d) {
            var p = {};
            p.start = d.current_business;
            p.end = d.business;
            $scope.posi = p;
        };
        function user(d) {
            var u = {};
            u.name = d.User.nickname;
            if (d.User.img) {
                u.img = "__ROOT__/Uploads/UserIcon/" + d.User.img;
            } else {
                u.img = "__ROOT__/Uploads/UserIcon/default.jpg";
            }
            $scope.u = u;
        }
        function preference(d){
            var config = {
                params: {
                    'user_id': d.User.id
                }
            };
            $http.get("{:U('Demand/preference')}", config).then(
                    function successCallback(response) {
                        var preference_data = response.data;
                        createRadar()
                        console.log(preference_data);
                    },
                    function errCallback(response) {
                        alert('error');
                    }
            );
        }
    });
</script>
</body>
</html>